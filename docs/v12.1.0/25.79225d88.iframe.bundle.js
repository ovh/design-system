(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"../../stencil/components/flag/dist/esm/osds-flag.entry.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"osds_flag",(function(){return osds_flag_a05a8ccc_OsdsFlag}));__webpack_require__("../../../node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../../../node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../../../node_modules/core-js/modules/es.object.values.js"),__webpack_require__("../../../node_modules/core-js/modules/es.map.js"),__webpack_require__("../../../node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../../../node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../../../node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../../../node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../../../node_modules/core-js/modules/es.promise.js"),__webpack_require__("../../../node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("../../../node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("../../../node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../../../node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("../../../node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../../../node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("../../../node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("../../../node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("../../../node_modules/core-js/modules/es.reflect.construct.js"),__webpack_require__("../../../node_modules/core-js/modules/es.object.create.js");var ods_html_anchor_element_rel_3e2d0c60=__webpack_require__("../../stencil/components/flag/dist/esm/ods-html-anchor-element-rel-3e2d0c60.js");function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var OdsComponentController=function OdsComponentController(component){_classCallCheck(this,OdsComponentController),this.component=component};var osds_flag_a05a8ccc_OdsLoadContent=function(){function OdsLoadContent(){var contentValidators=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,OdsLoadContent),this.contentCache=new Map,this.contentValidators=[],this.logger=new ods_html_anchor_element_rel_3e2d0c60.c("OdsLoadContent"),this.requestCache=new Map,this.contentValidators=contentValidators}return _createClass(OdsLoadContent,[{key:"load",value:function load(url,isVisible){var _this=this,sanitize=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],isBrowser=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(resolve,reject){isBrowser&&isVisible&&url?_this.contentCache.has(url)?resolve(_this.contentCache.get(url)):_this.getContent(url,sanitize).then((function(){return resolve(_this.contentCache.get(url))})).catch((function(reason){return reject(reason)})):resolve(void 0)}))}},{key:"onDestroy",value:function onDestroy(){this.io&&(this.io.disconnect(),this.io=void 0)}},{key:"waitUntilVisible",value:function waitUntilVisible(el,rootMargin,cb,lazy){var _this2=this,isBrowser=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(isBrowser&&lazy&&"undefined"!=typeof window&&window.IntersectionObserver){this.logger.log("[waitUntilVisible] use intersection");var io=this.io=new window.IntersectionObserver((function(data){_this2.logger.log("[waitUntilVisible] compute change"),data[0].isIntersecting&&(_this2.logger.log("[waitUntilVisible] isIntersecting"),io.disconnect(),_this2.io=void 0,cb())}),{rootMargin:rootMargin});this.logger.log("[waitUntilVisible] observe"),io.observe(el)}else this.logger.log("[waitUntilVisible] no using intersection"),cb()}},{key:"getContent",value:function getContent(url,sanitize){var _this3=this,req=this.requestCache.get(url);if(!req){if("undefined"==typeof fetch||"undefined"==typeof document)return this.contentCache.set(url,""),Promise.resolve();req=fetch(url).then((function(rsp){if(rsp.ok)return rsp.text().then((function(svgContent){return svgContent&&sanitize&&(svgContent=_this3.sanitize(svgContent,url)),_this3.contentCache.set(url,svgContent||""),svgContent}));_this3.logger.error("[getContent]","response is not ok",{url:url}),_this3.contentCache.set(url,"")})).catch((function(error){throw _this3.logger.error("[getContent]","request failed",{url:url}),_this3.contentCache.set(url,""),error})),this.requestCache.set(url,req)}return req}},{key:"sanitize",value:function sanitize(content,url){var _this4=this,sanitized=content;return this.contentValidators.forEach((function(validator){try{sanitized=validator(sanitized)}catch(e){_this4.logger.error("[sanitize]","error calling validator for the loaded content from url",{url:url})}})),sanitized}}]),OdsLoadContent}();function odsIsStr(val){return"string"==typeof val}var OdsSvgValidator=function(){function OdsSvgValidator(){_classCallCheck(this,OdsSvgValidator)}return _createClass(OdsSvgValidator,null,[{key:"isValid",value:function isValid(elm){if(1===elm.nodeType){if("script"===elm.nodeName.toLowerCase())return!1;for(var i=0;i<elm.attributes.length;i++){var name=elm.attributes[i].name;if(odsIsStr(name)&&0===name.toLowerCase().indexOf("on"))return!1}for(var _i=0;_i<elm.childNodes.length;_i++)if(!this.isValid(elm.childNodes[_i]))return!1}return!0}},{key:"validateContent",value:function validateContent(svgContent){var div=document.createElement("div");div.innerHTML=svgContent;for(var i=div.childNodes.length-1;i>=0;i--)"svg"!==div.childNodes[i].nodeName.toLowerCase()&&div.removeChild(div.childNodes[i]);var svgElm=div.firstElementChild;if(svgElm&&"svg"===svgElm.nodeName.toLowerCase()){var svgClass=svgElm.getAttribute("class")||"";if(svgElm.setAttribute("class",svgClass.trim()),this.isValid(svgElm))return div.innerHTML}return""}}]),OdsSvgValidator}();var osds_flag_a05a8ccc_OdsFlagController=function(_OdsComponentControll){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(OdsFlagController,_OdsComponentControll);var _super=_createSuper(OdsFlagController);function OdsFlagController(component){var _this5;return _classCallCheck(this,OdsFlagController),(_this5=_super.call(this,component)).logger=new ods_html_anchor_element_rel_3e2d0c60.c("OdsFlagController"),_this5.svgLoadContent=new osds_flag_a05a8ccc_OdsLoadContent([function(content){return OdsSvgValidator.validateContent(content)}]),_this5}return _createClass(OdsFlagController,[{key:"load",value:function load(isVisible){var isBrowser=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.validateISO(this.component.iso);var url=this.getUrl();return this.svgLoadContent.load(url||"",isVisible,!0,isBrowser)}},{key:"onDestroy",value:function onDestroy(){this.svgLoadContent.onDestroy()}},{key:"onInit",value:function onInit(onBecomeVisible){var _this6=this,isBrowser=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.logger.log("[onInit] wait until is visible"),this.svgLoadContent.waitUntilVisible(this.component.hostElement,"50px",(function(){onBecomeVisible(),_this6.logger.log("[onInit] is visible: load it"),_this6.component.load()}),this.component.lazy,isBrowser)}},{key:"validateISO",value:function validateISO(iso){iso&&function odsIsTermInEnum(term,set){return Object.values(set).includes(term)}(iso,ods_html_anchor_element_rel_3e2d0c60.g)||(this.component.iso=void 0,this.logger.warn("The iso attribute must be one of those values "+ods_html_anchor_element_rel_3e2d0c60.f))}},{key:"getUrl",value:function getUrl(){var url=function odsGetSrc(src){if(odsIsStr(src)&&function odsIsSrc(str){return str.length>0&&/([/.])/.test(str)}(src=src.trim()))return src}(this.component.src);if(url)return url;var iso=this.component.iso;return iso?this.getUrlForIso(iso,this.component.assetPath):void 0}},{key:"getUrlForIso",value:function getUrlForIso(iso,customPath){var path=function odsGetAssetPath(path){var customPath=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log("odsGetAssetPath path=",path),console.log("odsGetAssetPath customPath=",customPath),console.log("odsGetAssetPath getting instance...");var instance=ods_html_anchor_element_rel_3e2d0c60.d.instance();return console.log("odsGetAssetPath instance.config=",JSON.stringify(instance.getConfig())),customPath||(console.log("!customPath"),customPath=instance.getConfig().asset.path,console.log("customPath",customPath)),""+customPath+path}(iso+".svg",customPath);return this.component.getAssetPath(""+path)}}]),OdsFlagController}(OdsComponentController),odsFlagDefaultAttributes={iso:ods_html_anchor_element_rel_3e2d0c60.g.FR,lazy:!1},osds_flag_a05a8ccc_OsdsFlag=function(){function OsdsFlag(hostRef){_classCallCheck(this,OsdsFlag),Object(ods_html_anchor_element_rel_3e2d0c60.k)(this,hostRef),this.controller=new osds_flag_a05a8ccc_OdsFlagController(this),this.assetPath=odsFlagDefaultAttributes.assetPath,this.iso=odsFlagDefaultAttributes.iso,this.lazy=odsFlagDefaultAttributes.lazy,this.src=odsFlagDefaultAttributes.src,this.visible=!1,this.logger=new ods_html_anchor_element_rel_3e2d0c60.c("OsdsFlag")}return _createClass(OsdsFlag,[{key:"connectedCallback",value:function connectedCallback(){this.logger.log("flag connectedCallback"),this.onInit()}},{key:"disconnectedCallback",value:function disconnectedCallback(){this.onDestroy()}},{key:"getAssetPath",value:function getAssetPath(url){return this.logger.log("flag getAssetPath"),url}},{key:"load",value:function load(){var _this7=this;this.logger.log("flag load"),this.logger.log("[load]",this.iso+" - iso, assetPath or src updated. load..."),this.controller.load(this.visible,ods_html_anchor_element_rel_3e2d0c60.a.isBrowser).then((function(svgContent){_this7.logger.log("[load]",_this7.iso+" - content loaded"),_this7.svgContent=svgContent||""})),this.ariaLabel=this.iso}},{key:"onDestroy",value:function onDestroy(){this.controller.onDestroy()}},{key:"onInit",value:function onInit(){var _this8=this;this.logger.log("flag onInit"),this.logger.log("[onInit]"),this.controller.onInit((function(){_this8.visible=!0}),ods_html_anchor_element_rel_3e2d0c60.a.isBrowser)}},{key:"render",value:function render(){this.logger.log("flag render");var hostElement,ariaLabel=this.ariaLabel;return Object(ods_html_anchor_element_rel_3e2d0c60.i)(ods_html_anchor_element_rel_3e2d0c60.b,{"aria-label":ariaLabel&&(hostElement=this.hostElement,!hostElement.hasAttribute("aria-hidden")||"true"!==hostElement.getAttribute("aria-hidden"))?ariaLabel:null,role:"img"},this.svgContent?Object(ods_html_anchor_element_rel_3e2d0c60.i)("div",{class:"svg-inner",innerHTML:this.svgContent}):Object(ods_html_anchor_element_rel_3e2d0c60.i)("div",{class:"svg-inner flag-default"}))}},{key:"hostElement",get:function get(){return Object(ods_html_anchor_element_rel_3e2d0c60.h)(this)}}],[{key:"watchers",get:function get(){return{iso:["load"],assetPath:["load"],src:["load"]}}}]),OsdsFlag}();osds_flag_a05a8ccc_OsdsFlag.style=':host{display:block;box-shadow:0 0 var(--ods-size-05) var(--ods-color-gray-200);aspect-ratio:4/3}@supports not (aspect-ratio: 4/3){:host::before{float:left;padding-top:75%;content:""}:host::after{display:block;content:"";clear:both}}.svg-inner{display:flex}.svg-inner.flag-default{height:100%;width:100%;background:var(--ods-color-gray-200)}'}}]);