import{p as u,H as _,h as s,a as m,c}from"./index-DAZhnxgO.js";import{g as y}from"./dom-CO1DdTQY.js";import{d as b,O as w,a as h}from"./ods-button2-Bhm26DQr.js";import{O as t}from"./icon-name-C6aMXAXT.js";import{d as g}from"./ods-icon2-Bl6f3POv.js";import{d as x}from"./ods-progress-bar2-BuFm8qT0.js";import{d as z}from"./ods-spinner2-DCN2yKlT.js";import{d as k}from"./ods-divider2-Dc25YIYb.js";function v(o,e=0){if(typeof o!="number"||o<0)return"";if(o===0)return"0 b";const l=["b","kb","mb","gb","tb","pb","eb","zb","yb"],i=e<0?0:e,a=1024,d=Math.floor(Math.log(o)/Math.log(a));return`${parseFloat((o/a**d).toFixed(i))} ${l[d]}`}function D(o){var e;return((e=o==null?void 0:o.files)===null||e===void 0?void 0:e.length)>0?Array.from(o.files):(Array.from(o.items)||[]).filter(l=>l.kind==="file").map(l=>l.getAsFile())}function L(o,e){if(!o)return!1;if(!e)return!0;const l=(o.type||"").toLowerCase(),i=l.replace(/\/.*$/,"");return e.split(",").some(a=>{const d=a.trim().toLowerCase();return d.charAt(0)==="."?o.name.toLowerCase().endsWith(d):d.endsWith("/*")?i===d.replace(/\/.*$/,""):l===d})}const E=":host(.ods-file-upload){display:inline-flex;flex-flow:column;row-gap:8px;border:dashed 1px var(--ods-color-form-element-border-default);border-radius:4px;overflow:hidden;color:var(--ods-color-text)}:host(.ods-file-upload--disabled){border-color:var(--ods-color-border-disabled-default);background-color:var(--ods-color-background-disabled-default);cursor:not-allowed;color:var(--ods-color-text-disabled-default)}:host(.ods-file-upload--disabled) .ods-file-upload__dropzone__icon{color:var(--ods-color-text-disabled-default)}:host(.ods-file-upload--error){border-color:var(--ods-color-critical-500)}.ods-file-upload__dropzone{display:inline-flex;flex-flow:column;row-gap:8px;align-items:center;padding:24px 24px 0}.ods-file-upload__dropzone--dragging{background-color:var(--ods-color-primary-100)}.ods-file-upload__dropzone--empty{padding:24px}.ods-file-upload__dropzone__input{display:none}.ods-file-upload__dropzone__icon{color:var(--ods-color-primary-500);font-size:2rem}.ods-file-upload__dropzone__rules{display:flex;flex-flow:column;align-self:flex-start}.ods-file-upload__dropzone__rules__file-format,.ods-file-upload__dropzone__rules__max-file,.ods-file-upload__dropzone__rules__max-size{font-size:0.75rem}.ods-file-upload__dropzone__error{display:flex;flex-flow:column;row-gap:8px;width:100%;color:var(--ods-color-critical-500);font-size:0.75rem;font-weight:600}.ods-file-upload__list{display:flex;flex-flow:column;row-gap:4px;padding-bottom:24px}:host(.ods-file-upload-item){display:grid;grid-template-columns:max-content 1fr;-moz-column-gap:8px;column-gap:8px;align-items:flex-start;padding:0 24px;color:var(--ods-color-text)}:host(.ods-file-upload-item--disabled){border-color:var(--ods-color-border-disabled-default);background-color:var(--ods-color-background-disabled-default);cursor:not-allowed;color:var(--ods-color-text-disabled-default)}:host(.ods-file-upload-item--disabled) .ods-file-upload-item__icon{color:var(--ods-color-text-disabled-default)}.ods-file-upload-item__icon{margin-top:4px;color:var(--ods-color-primary-500);font-size:1.5rem}.ods-file-upload-item__file{display:flex;flex-flow:column;row-gap:4px}.ods-file-upload-item__file__info{display:grid;grid-template-columns:1fr max-content max-content;-moz-column-gap:8px;column-gap:8px;align-items:baseline}.ods-file-upload-item__file__info__name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ods-file-upload-item__file__info__remove::part(button),.ods-file-upload-item__file__info__size{font-size:0.75rem}.ods-file-upload-item__file__error{color:var(--ods-color-critical-500);font-size:0.75rem;font-weight:600}.ods-file-upload-item__file__progress{display:grid;grid-template-columns:1fr max-content;-moz-column-gap:8px;column-gap:8px;align-items:center;font-size:0.875rem;font-weight:600}.ods-file-upload-item__file__progress__bar::part(progress){width:100%}.ods-file-upload-item__file__success{color:var(--ods-color-success-500);font-size:0.75rem;font-weight:600}",C=E,S=u(class extends _{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.cancelHandler=void 0,this.error="",this.isDisabled=!1,this.isUploaded=!1,this.name=void 0,this.progress=void 0,this.size=void 0,this.successLabel=void 0}renderStatus(){return this.error?s("span",{class:"ods-file-upload-item__file__error"},this.error):this.progress&&this.progress<100?s("div",{class:"ods-file-upload-item__file__progress"},s("ods-progress-bar",{class:"ods-file-upload-item__file__progress__bar",max:100,value:this.progress}),s("span",null,this.progress,"%")):this.isUploaded?s("span",{class:"ods-file-upload-item__file__success"},s("ods-icon",{name:t.check})," ",this.successLabel):s("span",null)}render(){return s(m,{key:"81903268063b79c977e155270a7a7d2b1590997e",class:{"ods-file-upload-item":!0,"ods-file-upload-item--disabled":this.isDisabled}},s("ods-icon",{key:"4dbe310108d144a72bcee2204068ce3b047474fc",class:"ods-file-upload-item__icon",name:t.file}),s("div",{key:"77e26f2681508bb1be8fc25c88d8f4043d4b8ae6",class:"ods-file-upload-item__file"},s("div",{key:"fa1d447b546f865281e13519dd945b5b5e40df10",class:"ods-file-upload-item__file__info"},s("span",{key:"a930478dcb2ad969201d9f4b12cddc7909e2d818",class:"ods-file-upload-item__file__info__name"},this.name),s("span",{key:"ea85e1e8df9f2a196bbe219bf84a032cfe44655a",class:"ods-file-upload-item__file__info__size"},v(this.size)),s("ods-button",{key:"879a3a9eb8667f493d69f91114b59b713b738b67",class:"ods-file-upload-item__file__info__remove",icon:t.xmark,isDisabled:this.isDisabled,label:"",onClick:()=>this.cancelHandler(),size:w.sm,variant:h.ghost})),this.renderStatus()))}static get style(){return C}},[1,"ods-file-upload-item",{cancelHandler:[16],error:[513],isDisabled:[516,"is-disabled"],isUploaded:[516,"is-uploaded"],name:[513],progress:[514],size:[514],successLabel:[513,"success-label"]}]);function F(){if(typeof customElements>"u")return;["ods-file-upload-item","ods-button","ods-icon","ods-progress-bar","ods-spinner"].forEach(e=>{switch(e){case"ods-file-upload-item":customElements.get(e)||customElements.define(e,S);break;case"ods-button":customElements.get(e)||b();break;case"ods-icon":customElements.get(e)||g();break;case"ods-progress-bar":customElements.get(e)||x();break;case"ods-spinner":customElements.get(e)||z();break}})}F();var r;(function(o){o.maxFileReached="max-file-reached",o.sizeTooLarge="size-too-large",o.wrongFormat="wrong-format"})(r||(r={}));Object.freeze(Object.values(r));function j(o,e,l){return!l&&l!==0?{rejectedFiles:[],validFiles:o}:{rejectedFiles:o.slice(l-e,o.length),validFiles:o.slice(0,l-e)}}function O(o,e){return!e&&e!==0?{rejectedFiles:[],validFiles:o}:o.reduce((l,i)=>(i.size>e?l.rejectedFiles.push(i):l.validFiles.push(i),l),{rejectedFiles:[],validFiles:[]})}function U(o,e){return o.reduce((l,i)=>(L(i,e)?l.validFiles.push(i):l.rejectedFiles.push(i),l),{rejectedFiles:[],validFiles:[]})}const A=":host(.ods-file-upload){display:inline-flex;flex-flow:column;row-gap:8px;border:dashed 1px var(--ods-color-form-element-border-default);border-radius:4px;overflow:hidden;color:var(--ods-color-text)}:host(.ods-file-upload--disabled){border-color:var(--ods-color-border-disabled-default);background-color:var(--ods-color-background-disabled-default);cursor:not-allowed;color:var(--ods-color-text-disabled-default)}:host(.ods-file-upload--disabled) .ods-file-upload__dropzone__icon{color:var(--ods-color-text-disabled-default)}:host(.ods-file-upload--error){border-color:var(--ods-color-critical-500)}.ods-file-upload__dropzone{display:inline-flex;flex-flow:column;row-gap:8px;align-items:center;padding:24px 24px 0}.ods-file-upload__dropzone--dragging{background-color:var(--ods-color-primary-100)}.ods-file-upload__dropzone--empty{padding:24px}.ods-file-upload__dropzone__input{display:none}.ods-file-upload__dropzone__icon{color:var(--ods-color-primary-500);font-size:2rem}.ods-file-upload__dropzone__rules{display:flex;flex-flow:column;align-self:flex-start}.ods-file-upload__dropzone__rules__file-format,.ods-file-upload__dropzone__rules__max-file,.ods-file-upload__dropzone__rules__max-size{font-size:0.75rem}.ods-file-upload__dropzone__error{display:flex;flex-flow:column;row-gap:8px;width:100%;color:var(--ods-color-critical-500);font-size:0.75rem;font-weight:600}.ods-file-upload__list{display:flex;flex-flow:column;row-gap:4px;padding-bottom:24px}",$=A,H=u(class extends _{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.odsCancel=c(this,"odsCancel",7),this.odsChange=c(this,"odsChange",7),this.odsRejected=c(this,"odsRejected",7),this.isDragging=!1,this.accept="",this.acceptedFileLabel=void 0,this.browseFileLabel="Browse files",this.dropzoneLabel="Drag & drop a file",this.error="",this.files=[],this.isDisabled=!1,this.maxFile=void 0,this.maxFileLabel=void 0,this.maxSize=void 0,this.maxSizeLabel=void 0,this.uploadSuccessLabel="File uploaded"}browseFiles(){var e;(e=this.inputFile)===null||e===void 0||e.click()}handleFiles(e){const{rejectedFiles:l,validFiles:i}=U(e,this.accept);l.length&&this.odsRejected.emit({files:l,reason:r.wrongFormat});const{rejectedFiles:a,validFiles:d}=O(i,this.maxSize);a.length&&this.odsRejected.emit({files:a,reason:r.sizeTooLarge});const{rejectedFiles:n,validFiles:f}=j(d,this.files.length,this.maxFile);n.length&&this.odsRejected.emit({files:n,reason:r.maxFileReached}),f.length&&this.odsChange.emit({files:f.map(p=>(p.odsId=y(),p)),noError:l.length===0&&a.length===0&&n.length===0})}onDragEnter(){this.isDisabled||(this.isDragging=!0)}onDragLeave(){this.isDragging=!1}onDrop(e){e.preventDefault(),!this.isDisabled&&e.dataTransfer&&this.handleFiles(D(e.dataTransfer)),this.isDragging=!1}onFileCancel(e){this.odsCancel.emit(e)}onFileChange(e){const l=e.target.files;this.handleFiles(Array.from(l||[]))}render(){return s(m,{key:"8470cd13ba296bd70d1374518737201b138f7f74",class:{"ods-file-upload":!0,"ods-file-upload--disabled":this.isDisabled,"ods-file-upload--error":!!this.error},onDragEnter:()=>this.onDragEnter(),onDragLeave:()=>this.onDragLeave(),onDragOver:e=>e.preventDefault(),onDrop:e=>this.onDrop(e)},s("div",{key:"7aaea4e13e860d095f109ee1b8d9dd97cf6b42ca",class:{"ods-file-upload__dropzone":!0,"ods-file-upload__dropzone--dragging":this.isDragging,"ods-file-upload__dropzone--empty":this.files.length===0},part:"dropzone"},s("input",{key:"617c8380cc3ebb133b5ef99d003767eeed2f0214",class:"ods-file-upload__dropzone__input",accept:this.accept,disabled:this.isDisabled,multiple:!0,onChange:e=>this.onFileChange(e),ref:e=>this.inputFile=e,type:"file"}),s("ods-icon",{key:"48003a130e6acde3a3df61736c025999a55b145e",class:"ods-file-upload__dropzone__icon",name:t.filePlus}),s("span",{key:"1827b74ba27bc48fa1dd47538ac278f87c8ab8c5"},this.dropzoneLabel),s("div",{key:"d2e4597431c4850c6c7acc3e62006e7d9fe13b2f",class:"ods-file-upload__dropzone__rules"},this.maxFileLabel&&typeof this.maxFile=="number"&&this.maxFile>=0&&s("span",{key:"a3232ebbfc6783ff4d0516bfd27b3ee620b10186",class:"ods-file-upload__dropzone__rules__max-file"},this.maxFileLabel," ",this.maxFile),this.maxSizeLabel&&typeof this.maxSize=="number"&&this.maxSize>=0&&s("span",{key:"498b03196205270e59a28092a60a6d5bb1877202",class:"ods-file-upload__dropzone__rules__max-size"},this.maxSizeLabel," ",v(this.maxSize)),this.acceptedFileLabel&&s("span",{key:"975b44c6e62233c91e06b4e365ce5fb361cdd29f",class:"ods-file-upload__dropzone__rules__file-format"},this.acceptedFileLabel)),s("ods-button",{key:"f91cc9400b96d860d8d8cdd6e27f51d32b3fe8b1",icon:t.upload,isDisabled:this.isDisabled,label:this.browseFileLabel,onClick:()=>this.browseFiles(),variant:h.ghost}),!!this.error&&s("div",{key:"9c18f49cd5cb018002877a5e79961d028410e789",class:"ods-file-upload__dropzone__error"},s("span",{key:"9cbcaa34063bc7a5d490aac3980f0e1bc238bbd3"},this.error),s("ods-divider",{key:"dcd8bf24b4fcccbdcecf4c5fcc4cf7f4f6ce25dd"}))),this.files.length>0&&s("div",{key:"f787bd0631eb4c9272179508980ec492370b1818",class:"ods-file-upload__list",part:"file-list"},this.files.map(e=>s("ods-file-upload-item",{cancelHandler:()=>this.onFileCancel(e),error:e.error,isDisabled:this.isDisabled,isUploaded:e.isUploaded,name:e.name,progress:e.progress,size:e.size,successLabel:this.uploadSuccessLabel}))))}static get style(){return $}},[1,"ods-file-upload",{accept:[513],acceptedFileLabel:[513,"accepted-file-label"],browseFileLabel:[513,"browse-file-label"],dropzoneLabel:[513,"dropzone-label"],error:[513],files:[16],isDisabled:[516,"is-disabled"],maxFile:[514,"max-file"],maxFileLabel:[513,"max-file-label"],maxSize:[514,"max-size"],maxSizeLabel:[513,"max-size-label"],uploadSuccessLabel:[513,"upload-success-label"],isDragging:[32]}]);function T(){if(typeof customElements>"u")return;["ods-file-upload","ods-button","ods-divider","ods-file-upload-item","ods-icon","ods-progress-bar","ods-spinner"].forEach(e=>{switch(e){case"ods-file-upload":customElements.get(e)||customElements.define(e,H);break;case"ods-button":customElements.get(e)||b();break;case"ods-divider":customElements.get(e)||k();break;case"ods-file-upload-item":customElements.get(e)||F();break;case"ods-icon":customElements.get(e)||g();break;case"ods-progress-bar":customElements.get(e)||x();break;case"ods-spinner":customElements.get(e)||z();break}})}T();export{T as d};
