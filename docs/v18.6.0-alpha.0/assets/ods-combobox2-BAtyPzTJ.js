import{p as $,H as U,c as R,h as _,a as H,f as q}from"./index-DAZhnxgO.js";import{c as z}from"./_commonjsHelpers-CLD5em3H.js";import{d as K}from"./debounce-DRefBDpX.js";import{g as j,i as M,e as L,s as G,f as X}from"./dom-8hoR-urs.js";import{O as Y,g as Z}from"./overlay-KZpfSxWH.js";import{d as Q}from"./ods-button2-dPaqs0uX.js";import{d as ee}from"./ods-icon2-DRPHarK1.js";import{d as te}from"./ods-input2-C6KOqFAM.js";import{d as se}from"./ods-spinner2-CPyWCS2f.js";import{d as ie}from"./ods-tag2-Bb2BMy9d.js";const w="ods-internal-create-new-id",O=null;function oe(h,t){return t!==void 0&&h===O?t:h}function ne(){const h=document.createElement("input");return h.setAttribute("required","true"),h.validationMessage}function N(h){return h.map(t=>t.value).join(",")}function D(h){return Array.isArray(h)?h.join(","):h||""}function re(h,t=[],r=[]){return h?t.every(c=>(c.searchLabel||c.textContent||"").trim()!==(h==null?void 0:h.trim()))&&r.every(c=>c.text.trim()!==(h==null?void 0:h.trim())):!1}function ae(h){return Array.isArray(h)?h:h?h.split(","):[]}function V(h,t,r){h.setFormValue(t??""),!t&&r?h.setValidity({valueMissing:!0},ne()):h.setValidity({})}function T(h,t,r){if(r==="reset")return h.forEach(f=>f.isFocused=!1),-1;let c=t;if(t>=0&&(h[t].isFocused=!1),r==="down"){const f=h.findIndex((b,x)=>b.isVisible&&(!b.isSelected||b.id===w)&&x>t);f>t&&(c=f)}else{const f=h.findLastIndex((b,x)=>b.isVisible&&(!b.isSelected||b.id===w)&&x<t);f>=0&&f<t&&(c=f)}return c>=0&&(h[c].isFocused=!0),c}const le=":host(.ods-combobox-item){display:flex;align-items:center;cursor:pointer;padding:0 8px;min-height:32px;color:var(--ods-color-text)}:host(.ods-combobox-item) ::slotted(.ods-combobox-item--highlighted){font-weight:600}:host(.ods-combobox-item:hover),:host(.ods-combobox-item--focused){background-color:var(--ods-color-primary-100)}:host(.ods-combobox-item--hidden){display:none}",ue=le,ce=$(class extends U{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.odsComboboxSelected=R(this,"odsComboboxSelected",7),this.internalId=j(),this.isFocused=!1,this.isSelected=!1,this.isVisible=!1,this.searchLabel=void 0,this.selectionLabel=void 0,this.value=void 0}async select(){var t,r;this.odsComboboxSelected.emit({id:this.el.id,text:((t=this.selectionLabel)===null||t===void 0?void 0:t.trim())||((r=this.el.textContent)===null||r===void 0?void 0:r.trim())||"",value:this.value})}componentDidLoad(){!this.value&&this.el.id!==w&&console.warn("[OdsComboboxItem] combobox item without any value set detected, this will cause unexpected behaviours. Please set a unique value to each item component.")}render(){const t=this.el.id===w?!this.isVisible:!this.isVisible||this.isSelected;return _(H,{key:"1d0ced6f23fc322982eecbad2250ee43646fd9c5","aria-hidden":t,"aria-selected":this.isFocused,class:{"ods-combobox-item":!0,"ods-combobox-item--focused":this.isFocused,"ods-combobox-item--hidden":t},id:this.el.id||this.internalId,onClick:()=>this.select(),role:"option"},_("div",{key:"80f4078355f528c0b4b4d403247391bb031a2ca4"},_("slot",{key:"c5d0b391891b8b3a07b1e7c389a25349dd837f56"})))}static get delegatesFocus(){return!0}get el(){return this}static get style(){return ue}},[17,"ods-combobox-item",{isFocused:[4,"is-focused"],isSelected:[4,"is-selected"],isVisible:[4,"is-visible"],searchLabel:[513,"search-label"],selectionLabel:[513,"selection-label"],value:[513],select:[64]}]);function P(){if(typeof customElements>"u")return;["ods-combobox-item"].forEach(t=>{switch(t){case"ods-combobox-item":customElements.get(t)||customElements.define(t,ce);break}})}P();var B={exports:{}};/*!***************************************************
* mark.js v8.11.1
* https://markjs.io/
* Copyright (c) 2014–2018, Julian Kühnel
* Released under the MIT license https://git.io/vwTVl
*****************************************************/(function(h,t){(function(r,c){h.exports=c()})(z,function(){var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c=function(v,u){if(!(v instanceof u))throw new TypeError("Cannot call a class as a function")},f=function(){function v(u,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(u,s.key,s)}}return function(u,e,i){return e&&v(u.prototype,e),i&&v(u,i),u}}(),b=Object.assign||function(v){for(var u=1;u<arguments.length;u++){var e=arguments[u];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(v[i]=e[i])}return v},x=function(){function v(u){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;c(this,v),this.ctx=u,this.iframes=e,this.exclude=i,this.iframesTimeout=s}return f(v,[{key:"getContexts",value:function(){var e=void 0,i=[];return typeof this.ctx>"u"||!this.ctx?e=[]:NodeList.prototype.isPrototypeOf(this.ctx)?e=Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?e=this.ctx:typeof this.ctx=="string"?e=Array.prototype.slice.call(document.querySelectorAll(this.ctx)):e=[this.ctx],e.forEach(function(s){var o=i.filter(function(n){return n.contains(s)}).length>0;i.indexOf(s)===-1&&!o&&i.push(s)}),i}},{key:"getIframeContents",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},o=void 0;try{var n=e.contentWindow;if(o=n.document,!n||!o)throw new Error("iframe inaccessible")}catch{s()}o&&i(o)}},{key:"isIframeBlank",value:function(e){var i="about:blank",s=e.getAttribute("src").trim(),o=e.contentWindow.location.href;return o===i&&s!==i&&s}},{key:"observeIframeLoad",value:function(e,i,s){var o=this,n=!1,l=null,a=function d(){if(!n){n=!0,clearTimeout(l);try{o.isIframeBlank(e)||(e.removeEventListener("load",d),o.getIframeContents(e,i,s))}catch{s()}}};e.addEventListener("load",a),l=setTimeout(a,this.iframesTimeout)}},{key:"onIframeReady",value:function(e,i,s){try{e.contentWindow.document.readyState==="complete"?this.isIframeBlank(e)?this.observeIframeLoad(e,i,s):this.getIframeContents(e,i,s):this.observeIframeLoad(e,i,s)}catch{s()}}},{key:"waitForIframes",value:function(e,i){var s=this,o=0;this.forEachIframe(e,function(){return!0},function(n){o++,s.waitForIframes(n.querySelector("html"),function(){--o||i()})},function(n){n||i()})}},{key:"forEachIframe",value:function(e,i,s){var o=this,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(){},l=e.querySelectorAll("iframe"),a=l.length,d=0;l=Array.prototype.slice.call(l);var m=function(){--a<=0&&n(d)};a||m(),l.forEach(function(p){v.matches(p,o.exclude)?m():o.onIframeReady(p,function(g){i(p)&&(d++,s(g)),m()},m)})}},{key:"createIterator",value:function(e,i,s){return document.createNodeIterator(e,i,s,!1)}},{key:"createInstanceOnIframe",value:function(e){return new v(e.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(e,i,s){var o=e.compareDocumentPosition(s),n=Node.DOCUMENT_POSITION_PRECEDING;if(o&n)if(i!==null){var l=i.compareDocumentPosition(s),a=Node.DOCUMENT_POSITION_FOLLOWING;if(l&a)return!0}else return!0;return!1}},{key:"getIteratorNode",value:function(e){var i=e.previousNode(),s=void 0;return i===null?s=e.nextNode():s=e.nextNode()&&e.nextNode(),{prevNode:i,node:s}}},{key:"checkIframeFilter",value:function(e,i,s,o){var n=!1,l=!1;return o.forEach(function(a,d){a.val===s&&(n=d,l=a.handled)}),this.compareNodeIframe(e,i,s)?(n===!1&&!l?o.push({val:s,handled:!0}):n!==!1&&!l&&(o[n].handled=!0),!0):(n===!1&&o.push({val:s,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(e,i,s,o){var n=this;e.forEach(function(l){l.handled||n.getIframeContents(l.val,function(a){n.createInstanceOnIframe(a).forEachNode(i,s,o)})})}},{key:"iterateThroughNodes",value:function(e,i,s,o,n){for(var l=this,a=this.createIterator(i,e,o),d=[],m=[],p=void 0,g=void 0,y=function(){var I=l.getIteratorNode(a);return g=I.prevNode,p=I.node,p};y();)this.iframes&&this.forEachIframe(i,function(E){return l.checkIframeFilter(p,g,E,d)},function(E){l.createInstanceOnIframe(E).forEachNode(e,function(I){return m.push(I)},o)}),m.push(p);m.forEach(function(E){s(E)}),this.iframes&&this.handleOpenIframes(d,e,s,o),n()}},{key:"forEachNode",value:function(e,i,s){var o=this,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(){},l=this.getContexts(),a=l.length;a||n(),l.forEach(function(d){var m=function(){o.iterateThroughNodes(e,d,i,s,function(){--a<=0&&n()})};o.iframes?o.waitForIframes(d,m):m()})}}],[{key:"matches",value:function(e,i){var s=typeof i=="string"?[i]:i,o=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(o){var n=!1;return s.every(function(l){return o.call(e,l)?(n=!0,!1):!0}),n}else return!1}}]),v}(),C=function(){function v(u){c(this,v),this.ctx=u,this.ie=!1;var e=window.navigator.userAgent;(e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1)&&(this.ie=!0)}return f(v,[{key:"log",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"debug",s=this.opt.log;this.opt.debug&&(typeof s>"u"?"undefined":r(s))==="object"&&typeof s[i]=="function"&&s[i]("mark.js: "+e)}},{key:"escapeStr",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(e){return this.opt.wildcards!=="disabled"&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),this.opt.wildcards!=="disabled"&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e),e}},{key:"createSynonymsRegExp",value:function(e){var i=this.opt.synonyms,s=this.opt.caseSensitive?"":"i",o=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var n in i)if(i.hasOwnProperty(n)){var l=i[n],a=this.opt.wildcards!=="disabled"?this.setupWildcardsRegExp(n):this.escapeStr(n),d=this.opt.wildcards!=="disabled"?this.setupWildcardsRegExp(l):this.escapeStr(l);a!==""&&d!==""&&(e=e.replace(new RegExp("("+this.escapeStr(a)+"|"+this.escapeStr(d)+")","gm"+s),o+("("+this.processSynomyms(a)+"|")+(this.processSynomyms(d)+")")+o))}return e}},{key:"processSynomyms",value:function(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}},{key:"setupWildcardsRegExp",value:function(e){return e=e.replace(/(?:\\)*\?/g,function(i){return i.charAt(0)==="\\"?"?":""}),e.replace(/(?:\\)*\*/g,function(i){return i.charAt(0)==="\\"?"*":""})}},{key:"createWildcardsRegExp",value:function(e){var i=this.opt.wildcards==="withSpaces";return e.replace(/\u0001/g,i?"[\\S\\s]?":"\\S?").replace(/\u0002/g,i?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(e){return e.replace(/[^(|)\\]/g,function(i,s,o){var n=o.charAt(s+1);return/[(|)\\]/.test(n)||n===""?i:i+"\0"})}},{key:"createJoinersRegExp",value:function(e){var i=[],s=this.opt.ignorePunctuation;return Array.isArray(s)&&s.length&&i.push(this.escapeStr(s.join(""))),this.opt.ignoreJoiners&&i.push("\\u00ad\\u200b\\u200c\\u200d"),i.length?e.split(/\u0000+/).join("["+i.join("")+"]*"):e}},{key:"createDiacriticsRegExp",value:function(e){var i=this.opt.caseSensitive?"":"i",s=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],o=[];return e.split("").forEach(function(n){s.every(function(l){if(l.indexOf(n)!==-1){if(o.indexOf(l)>-1)return!1;e=e.replace(new RegExp("["+l+"]","gm"+i),"["+l+"]"),o.push(l)}return!0})}),e}},{key:"createMergedBlanksRegExp",value:function(e){return e.replace(/[\s]+/gmi,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(e){var i=this,s="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿",o=this.opt.accuracy,n=typeof o=="string"?o:o.value,l=typeof o=="string"?[]:o.limiters,a="";switch(l.forEach(function(d){a+="|"+i.escapeStr(d)}),n){case"partially":default:return"()("+e+")";case"complementary":return a="\\s"+(a||this.escapeStr(s)),"()([^"+a+"]*"+e+"[^"+a+"]*)";case"exactly":return"(^|\\s"+a+")("+e+")(?=$|\\s"+a+")"}}},{key:"getSeparatedKeywords",value:function(e){var i=this,s=[];return e.forEach(function(o){i.opt.separateWordSearch?o.split(" ").forEach(function(n){n.trim()&&s.indexOf(n)===-1&&s.push(n)}):o.trim()&&s.indexOf(o)===-1&&s.push(o)}),{keywords:s.sort(function(o,n){return n.length-o.length}),length:s.length}}},{key:"isNumeric",value:function(e){return Number(parseFloat(e))==e}},{key:"checkRanges",value:function(e){var i=this;if(!Array.isArray(e)||Object.prototype.toString.call(e[0])!=="[object Object]")return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];var s=[],o=0;return e.sort(function(n,l){return n.start-l.start}).forEach(function(n){var l=i.callNoMatchOnInvalidRanges(n,o),a=l.start,d=l.end,m=l.valid;m&&(n.start=a,n.length=d-a,s.push(n),o=d)}),s}},{key:"callNoMatchOnInvalidRanges",value:function(e,i){var s=void 0,o=void 0,n=!1;return e&&typeof e.start<"u"?(s=parseInt(e.start,10),o=s+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&o-i>0&&o-s>0?n=!0:(this.log("Ignoring invalid or overlapping range: "+(""+JSON.stringify(e))),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:s,end:o,valid:n}}},{key:"checkWhitespaceRanges",value:function(e,i,s){var o=void 0,n=!0,l=s.length,a=i-l,d=parseInt(e.start,10)-a;return d=d>l?l:d,o=d+parseInt(e.length,10),o>l&&(o=l,this.log("End range automatically set to the max value of "+l)),d<0||o-d<0||d>l||o>l?(n=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):s.substring(d,o).replace(/\s+/g,"")===""&&(n=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:d,end:o,valid:n}}},{key:"getTextNodes",value:function(e){var i=this,s="",o=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,function(n){o.push({start:s.length,end:(s+=n.textContent).length,node:n})},function(n){return i.matchesExclude(n.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},function(){e({value:s,nodes:o})})}},{key:"matchesExclude",value:function(e){return x.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(e,i,s){var o=this.opt.element?this.opt.element:"mark",n=e.splitText(i),l=n.splitText(s-i),a=document.createElement(o);return a.setAttribute("data-markjs","true"),this.opt.className&&a.setAttribute("class",this.opt.className),a.textContent=n.textContent,n.parentNode.replaceChild(a,n),l}},{key:"wrapRangeInMappedTextNode",value:function(e,i,s,o,n){var l=this;e.nodes.every(function(a,d){var m=e.nodes[d+1];if(typeof m>"u"||m.start>i){if(!o(a.node))return!1;var p=i-a.start,g=(s>a.end?a.end:s)-a.start,y=e.value.substr(0,a.start),E=e.value.substr(g+a.start);if(a.node=l.wrapRangeInTextNode(a.node,p,g),e.value=y+E,e.nodes.forEach(function(I,S){S>=d&&(e.nodes[S].start>0&&S!==d&&(e.nodes[S].start-=g),e.nodes[S].end-=g)}),s-=g,n(a.node.previousSibling,a.start),s>a.end)i=a.end;else return!1}return!0})}},{key:"wrapMatches",value:function(e,i,s,o,n){var l=this,a=i===0?0:i+1;this.getTextNodes(function(d){d.nodes.forEach(function(m){m=m.node;for(var p=void 0;(p=e.exec(m.textContent))!==null&&p[a]!=="";)if(s(p[a],m)){var g=p.index;if(a!==0)for(var y=1;y<a;y++)g+=p[y].length;m=l.wrapRangeInTextNode(m,g,g+p[a].length),o(m.previousSibling),e.lastIndex=0}}),n()})}},{key:"wrapMatchesAcrossElements",value:function(e,i,s,o,n){var l=this,a=i===0?0:i+1;this.getTextNodes(function(d){for(var m=void 0;(m=e.exec(d.value))!==null&&m[a]!=="";){var p=m.index;if(a!==0)for(var g=1;g<a;g++)p+=m[g].length;var y=p+m[a].length;l.wrapRangeInMappedTextNode(d,p,y,function(E){return s(m[a],E)},function(E,I){e.lastIndex=I,o(E)})}n()})}},{key:"wrapRangeFromIndex",value:function(e,i,s,o){var n=this;this.getTextNodes(function(l){var a=l.value.length;e.forEach(function(d,m){var p=n.checkWhitespaceRanges(d,a,l.value),g=p.start,y=p.end,E=p.valid;E&&n.wrapRangeInMappedTextNode(l,g,y,function(I){return i(I,d,l.value.substring(g,y),m)},function(I){s(I,d)})}),o()})}},{key:"unwrapMatches",value:function(e){for(var i=e.parentNode,s=document.createDocumentFragment();e.firstChild;)s.appendChild(e.removeChild(e.firstChild));i.replaceChild(s,e),this.ie?this.normalizeTextNode(i):i.normalize()}},{key:"normalizeTextNode",value:function(e){if(e){if(e.nodeType===3)for(;e.nextSibling&&e.nextSibling.nodeType===3;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}},{key:"markRegExp",value:function(e,i){var s=this;this.opt=i,this.log('Searching with expression "'+e+'"');var o=0,n="wrapMatches",l=function(d){o++,s.opt.each(d)};this.opt.acrossElements&&(n="wrapMatchesAcrossElements"),this[n](e,this.opt.ignoreGroups,function(a,d){return s.opt.filter(d,a,o)},l,function(){o===0&&s.opt.noMatch(e),s.opt.done(o)})}},{key:"mark",value:function(e,i){var s=this;this.opt=i;var o=0,n="wrapMatches",l=this.getSeparatedKeywords(typeof e=="string"?[e]:e),a=l.keywords,d=l.length,m=this.opt.caseSensitive?"":"i",p=function g(y){var E=new RegExp(s.createRegExp(y),"gm"+m),I=0;s.log('Searching with expression "'+E+'"'),s[n](E,1,function(S,W){return s.opt.filter(W,y,o,I)},function(S){I++,o++,s.opt.each(S)},function(){I===0&&s.opt.noMatch(y),a[d-1]===y?s.opt.done(o):g(a[a.indexOf(y)+1])})};this.opt.acrossElements&&(n="wrapMatchesAcrossElements"),d===0?this.opt.done(o):p(a[0])}},{key:"markRanges",value:function(e,i){var s=this;this.opt=i;var o=0,n=this.checkRanges(e);n&&n.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(n)),this.wrapRangeFromIndex(n,function(l,a,d,m){return s.opt.filter(l,a,d,m)},function(l,a){o++,s.opt.each(l,a)},function(){s.opt.done(o)})):this.opt.done(o)}},{key:"unmark",value:function(e){var i=this;this.opt=e;var s=this.opt.element?this.opt.element:"*";s+="[data-markjs]",this.opt.className&&(s+="."+this.opt.className),this.log('Removal selector "'+s+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,function(o){i.unwrapMatches(o)},function(o){var n=x.matches(o,s),l=i.matchesExclude(o);return!n||l?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}},{key:"opt",set:function(e){this._opt=b({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},e)},get:function(){return this._opt}},{key:"iterator",get:function(){return new x(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),v}();function k(v){var u=this,e=new C(v);return this.mark=function(i,s){return e.mark(i,s),u},this.markRegExp=function(i,s){return e.markRegExp(i,s),u},this.markRanges=function(i,s){return e.markRanges(i,s),u},this.unmark=function(i){return e.unmark(i),u},this}return k})})(B);const de=B.exports,J=/[\\^$.*+?()[\]{}|]/g,he=RegExp(J.source);function fe(h){return h&&he.test(h)?h.replace(J,"\\$&"):h||""}const me=":host(.ods-combobox-item){display:flex;align-items:center;cursor:pointer;padding:0 8px;min-height:32px;color:var(--ods-color-text)}:host(.ods-combobox-item) ::slotted(.ods-combobox-item--highlighted){font-weight:600}:host(.ods-combobox-item:hover),:host(.ods-combobox-item--focused){background-color:var(--ods-color-primary-100)}:host(.ods-combobox-item--hidden){display:none}:host(.ods-combobox){display:inline-block;position:relative}:host(.ods-combobox) ::slotted(ods-combobox-group:not(:first-child)){border-top:solid 1px var(--ods-color-neutral-100)}:host(.ods-combobox--fixed){position:fixed}.ods-combobox__search{display:flex;flex-wrap:wrap;gap:4px;align-items:center;border:var(--ods-border-width-sm) solid var(--ods-color-form-element-border-default);border-radius:var(--ods-border-radius-sm)}.ods-combobox__search--disabled{border-color:var(--ods-color-border-disabled-default);background-color:var(--ods-color-background-disabled-default);cursor:not-allowed;color:var(--ods-color-text-disabled-default)}.ods-combobox__search--error{border-color:var(--ods-color-form-element-border-critical)}.ods-combobox__search--focused{outline:var(--ods-outline-style-default) var(--ods-outline-width) var(--ods-outline-color-default);outline-offset:var(--ods-outline-offset)}.ods-combobox__search--read-only{border-color:var(--ods-color-border-readonly-default);background-color:var(--ods-color-background-readonly-default)}.ods-combobox__search--multiple{padding:4px 8px}.ods-combobox__search--multiple .ods-combobox__search__input{margin-right:-8px}.ods-combobox__search--multiple .ods-combobox__search__input::part(input){padding:0;height:calc(var(--ods-form-element-input-height) - 10px)}.ods-combobox__search--bottom{border-bottom-left-radius:0;border-bottom-right-radius:0}.ods-combobox__search--top{border-top-left-radius:0;border-top-right-radius:0}.ods-combobox__search__tag::part(tag):focus-visible{outline:none}.ods-combobox__search__input{flex:1 1 auto}.ods-combobox__search__input::part(input){border:0}.ods-combobox__search__input::part(input):focus{outline:0}.ods-combobox__results{box-sizing:border-box;position:absolute;top:0;left:0;visibility:hidden;z-index:97;margin:0;border:1px solid rgba(0, 0, 0, 0.15);border-radius:var(--ods-border-radius-sm);background:var(--ods-color-primary-000);padding:0;width:100%;height:auto;max-height:200px;overflow:hidden auto;list-style:none;line-height:1.5;color:var(--ods-color-text);scroll-behavior:smooth}.ods-combobox__results--open{visibility:visible}.ods-combobox__results--bottom{border-radius:0 0 var(--ods-border-radius-sm) var(--ods-border-radius-sm)}.ods-combobox__results--top{border-radius:var(--ods-border-radius-sm) var(--ods-border-radius-sm) 0 0}.ods-combobox__results__new{box-sizing:border-box;border-bottom:solid 1px var(--ods-color-neutral-100)}.ods-combobox__results__empty{display:flex;align-items:center;padding:0 8px;min-height:32px;color:var(--ods-color-text)}",pe=me,F="ods-combobox__search--focused",A="ods-combobox-item--highlighted",ve=$(class extends U{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.odsBlur=R(this,"odsBlur",7),this.odsChange=R(this,"odsChange",7),this.odsClear=R(this,"odsClear",7),this.odsFilter=R(this,"odsFilter",7),this.odsFocus=R(this,"odsFocus",7),this.odsInvalid=R(this,"odsInvalid",7),this.odsReset=R(this,"odsReset",7),this.internals=this.attachInternals(),this.currentFocusedItemIndex=-1,this.currentSelections=[],this.debouncedOnInput=K(()=>this.onInput(),100),this.resultElements=[],this.resultGroups=[],this.searchHeight=0,this.shouldResetOnBlur=!0,this.shouldUpdateIsInvalidState=!1,this.shouldUpdateSelection=!1,this.currentTagFocusedIndex=-1,this.hasNoResults=!1,this.isInvalid=void 0,this.isOpen=!1,this.addNewElementLabel="Add",this.allowMultiple=!1,this.defaultValue=void 0,this.hasError=!1,this.highlightResults=!1,this.isClearable=!1,this.isDisabled=!1,this.isLoading=!1,this.isReadonly=!1,this.isRequired=!1,this.name=void 0,this.noResultLabel="No results found",this.placeholder=void 0,this.strategy=Y.absolute,this.value=O}onDocumentClick(t){var r;M(t,this.el)||(this.isOpen&&this.closeDropdown(),(r=this.searchElement)===null||r===void 0||r.classList.remove(F))}onDocumentFocusin(t){this.isOpen&&!M(t,this.el)&&this.closeDropdown()}onInvalidEvent(t){t.preventDefault(),this.isInvalid=!0}onDocumentKeydown(t){this.isOpen&&t.key==="Escape"&&this.closeDropdown()}onOdsSwitchItemChange(t){var r;if(t.stopImmediatePropagation(),this.shouldUpdateSelection=!1,this.allowMultiple){this.currentSelections.push(t.detail.id===w?{text:t.detail.value,value:t.detail.value}:t.detail);const c=this.resultElements.find(f=>f.value===t.detail.value);c&&(c.isSelected=!0),this.value=N(this.currentSelections)}else this.currentSelections=t.detail.id===w?[{text:t.detail.value,value:t.detail.value}]:[t.detail],this.value=t.detail.value;this.currentFocusedItemIndex=T(this.resultElements,this.currentFocusedItemIndex,"reset"),this.closeDropdown(),(r=this.inputElement)===null||r===void 0||r.focus()}async checkValidity(){return this.isInvalid=!this.internals.validity.valid,this.internals.checkValidity()}async clear(){var t;this.odsClear.emit(),this.clearCombobox(),(t=this.inputElement)===null||t===void 0||t.focus()}async close(){return this.closeDropdown()}async getValidationMessage(){return this.internals.validationMessage}async getValidity(){return this.internals.validity}async open(){this.isDisabled||this.isReadonly||setTimeout(async()=>{await this.openResultList()},0)}async reportValidity(){return this.isInvalid=!this.internals.validity.valid,this.internals.reportValidity()}async reset(){this.odsReset.emit(),this.defaultValue?(this.shouldUpdateSelection=!0,this.value=this.defaultValue):this.clearCombobox()}async willValidate(){return this.internals.willValidate}onHighlightResultsChange(){var t;this.highlightResults?this.markInstance=new de(this.resultElements):((t=this.markInstance)===null||t===void 0||t.unmark(),this.markInstance=void 0)}onIsDisabledChange(){this.isDisabled&&this.closeDropdown()}onIsInvalidChange(){this.odsInvalid.emit({isInvalid:!!this.isInvalid})}componentWillLoad(){this.observer=new MutationObserver(t=>{for(const r of t)r.attributeName==="value"&&this.value!==r.oldValue&&this.onValueChange(r.oldValue),r.attributeName==="is-required"&&(V(this.internals,N(this.currentSelections),this.isRequired),this.isInvalid=!this.internals.validity.valid)}),this.resizeObserver=new ResizeObserver(t=>{for(const r of t)!this.searchHeight&&r.contentRect.height>0&&(this.searchHeight=r.contentRect.height),this.searchHeight!==r.contentRect.height&&(this.searchHeight=r.contentRect.height,this.isOpen&&this.openDropdown())}),this.shouldUpdateSelection=!0,this.value=oe(this.value,this.defaultValue)}async componentDidLoad(){var t,r,c;await this.onValueChange(),this.shouldUpdateIsInvalidState=!0,this.onHighlightResultsChange(),(t=this.observer)===null||t===void 0||t.observe(this.el,{attributeFilter:["value"],attributeOldValue:!0}),this.inputElement&&((r=this.observer)===null||r===void 0||r.observe(this.inputElement,{attributeFilter:["is-required"],attributeOldValue:!1})),this.searchElement&&((c=this.resizeObserver)===null||c===void 0||c.observe(this.searchElement))}disconnectedCallback(){var t,r;(t=this.observer)===null||t===void 0||t.disconnect(),(r=this.resizeObserver)===null||r===void 0||r.disconnect()}async formResetCallback(){await this.reset()}clearCombobox(){var t;this.currentSelections=[],(t=this.resultElements)===null||t===void 0||t.forEach(r=>{r.isSelected=!1}),this.shouldUpdateSelection=!1,this.value=O}closeDropdown(){var t,r;this.isOpen=!1,this.currentFocusedItemIndex=-1,(t=this.resultListElement)===null||t===void 0||t.classList.remove("ods-combobox__results--bottom","ods-combobox__results--top"),(r=this.searchElement)===null||r===void 0||r.classList.remove("ods-combobox__search--bottom","ods-combobox__search--top")}filterResults(t){var r,c,f,b;if((r=this.markInstance)===null||r===void 0||r.unmark(),t){const x=new RegExp(`.*${fe(t)}.*`,"i");let C=!0;(c=this.resultElements)===null||c===void 0||c.forEach(k=>{if(k.id===w)return;const v=(k.searchLabel||k.textContent||"").trim(),u=x.test(v);k.isVisible=u,u&&C&&(C=!1)}),(f=this.markInstance)===null||f===void 0||f.mark(t,{className:A,element:"span"}),this.hasNoResults=C}else(b=this.resultElements)===null||b===void 0||b.forEach(x=>{x.isVisible=!0}),this.hasNoResults=!1;this.updateCreateNewElement(),this.updateGroupsVisibility(),this.currentFocusedItemIndex=T(this.resultElements,this.currentFocusedItemIndex,"reset"),this.odsFilter.emit({filterValue:t,hasNoResults:this.hasNoResults})}focusCurrentTag(){var t;(t=this.searchElement)===null||t===void 0||t.querySelectorAll("ods-tag")[this.currentTagFocusedIndex].focus(),this.updateInputValue(),this.closeDropdown()}onBlur(t){var r,c,f,b;this.el.contains(t.relatedTarget)||((r=this.searchElement)===null||r===void 0||r.classList.remove(F),this.value!==((c=this.inputElement)===null||c===void 0?void 0:c.value)&&(!this.allowMultiple&&this.shouldResetOnBlur&&(((f=this.inputElement)===null||f===void 0?void 0:f.value)===""||((b=this.inputElement)===null||b===void 0?void 0:b.value)===null)?(this.shouldUpdateSelection=!0,this.value=O):this.updateInputValue()),this.shouldResetOnBlur=!0,this.isInvalid=!this.internals.validity.valid,this.closeDropdown())}onInput(){var t;this.filterResults(((t=this.inputElement)===null||t===void 0?void 0:t.value)||""),this.isOpen||this.openDropdown()}onInputClear(t){t.stopImmediatePropagation(),this.allowMultiple||(this.odsClear.emit(),this.shouldUpdateSelection=!0,this.value=O)}onInputClick(){var t;(t=this.searchElement)===null||t===void 0||t.classList.add(F),this.isReadonly||this.openResultList()}onInputFocus(){var t;(t=this.searchElement)===null||t===void 0||t.classList.add(F)}async onInputKeyDown(t){var r,c,f,b;if(!this.isReadonly)switch(t.key){case"ArrowDown":if(t.preventDefault(),this.isOpen||await this.openResultList(),this.currentFocusedItemIndex=T(this.resultElements,this.currentFocusedItemIndex,"down"),this.currentFocusedItemIndex>=0&&!L(this.resultElements[this.currentFocusedItemIndex],this.resultListElement))if(this.resultElements[this.currentFocusedItemIndex].offsetHeight)(r=this.resultListElement)===null||r===void 0||r.scroll({behavior:"smooth",top:this.resultElements[this.currentFocusedItemIndex].offsetTop-this.resultElements[this.currentFocusedItemIndex].offsetHeight});else{const{height:x}=this.resultElements[this.currentFocusedItemIndex].getBoundingClientRect();(c=this.resultListElement)===null||c===void 0||c.scrollBy({behavior:"smooth",top:x})}break;case"ArrowLeft":if(this.allowMultiple&&this.currentSelections.length){const x=(b=(f=this.inputElement)===null||f===void 0?void 0:f.shadowRoot)===null||b===void 0?void 0:b.querySelector("input");if(x){const{selectionStart:C,selectionEnd:k}=x;C===0&&k===0&&(this.currentTagFocusedIndex=this.currentSelections.length-1,this.focusCurrentTag())}}break;case"ArrowUp":t.preventDefault(),this.currentFocusedItemIndex=T(this.resultElements,this.currentFocusedItemIndex,"up"),this.currentFocusedItemIndex>=0&&!L(this.resultElements[this.currentFocusedItemIndex],this.resultListElement)&&this.resultElements[this.currentFocusedItemIndex].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"});break;case"Tab":this.isOpen&&!t.shiftKey&&this.currentFocusedItemIndex>=0&&(this.shouldResetOnBlur=!1,await this.resultElements[this.currentFocusedItemIndex].select());break}}async onInputKeyUp(t){t.key==="Enter"&&(this.isOpen&&this.currentFocusedItemIndex>=0?await this.resultElements[this.currentFocusedItemIndex].select():G(t,this.internals.form))}onSlotChange(t){this.resultElements=t.currentTarget.assignedElements().reduce((r,c)=>c.tagName==="ODS-COMBOBOX-ITEM"?(r.push(c),r):c.tagName==="ODS-COMBOBOX-GROUP"?(this.resultGroups.push(c),r.concat(Array.from(c.children||[]).filter(f=>f.tagName==="ODS-COMBOBOX-ITEM").map(f=>(f.groupId=c.id,f)))):r,[])}onTagKeyDown(t){var r;switch(t.key){case"ArrowLeft":t.preventDefault(),this.currentTagFocusedIndex>0&&(this.currentTagFocusedIndex=this.currentTagFocusedIndex-1,this.focusCurrentTag());break;case"ArrowRight":t.preventDefault(),this.currentSelections.length&&this.currentTagFocusedIndex<this.currentSelections.length-1?(this.currentTagFocusedIndex=this.currentTagFocusedIndex+1,this.focusCurrentTag()):(r=this.inputElement)===null||r===void 0||r.focus();break}}onTagRemove(t){var r;const c=this.resultElements.find(f=>f.value===t);c&&(c.isSelected=!1),this.currentSelections=this.currentSelections.filter(f=>f.value!==t),this.shouldUpdateSelection=!1,this.value=N(this.currentSelections),(this.currentSelections.length===0||this.currentTagFocusedIndex===-1||this.currentTagFocusedIndex>=this.currentSelections.length)&&(this.currentTagFocusedIndex=-1,(r=this.inputElement)===null||r===void 0||r.focus())}async onValueChange(t){this.shouldUpdateSelection&&(this.allowMultiple&&this.value?(this.updateCurrentSelection(),q(this.el)):(this.value&&!this.currentSelections.length||this.currentSelections.length&&this.value!==this.currentSelections[0].value)&&this.updateCurrentSelection()),this.shouldUpdateSelection=!0,this.updateInputValue();const r=N(this.currentSelections);V(this.internals,r,this.isRequired),this.shouldUpdateIsInvalidState&&(this.isInvalid=!this.internals.validity.valid,this.shouldUpdateIsInvalidState=!1),this.odsChange.emit({name:this.name,previousValue:t,validity:this.internals.validity,value:r})}async openDropdown(){var t;if(this.resultListElement&&this.searchElement){const{placement:r,y:c}=await Z("bottom",{popper:this.resultListElement,trigger:this.el},{offset:-1});Object.assign(this.resultListElement.style,{left:"0",top:`${c}px`}),this.isOpen=!0,(t=this.resultListElement)===null||t===void 0||t.scrollTo(0,0),this.resultListElement.classList.add(`ods-combobox__results--${r}`),this.searchElement.classList.add(`ods-combobox__search--${r}`)}}async openResultList(){this.inputElement&&(this.filterResults(this.inputElement.value),await this.openDropdown())}updateCreateNewElement(){var t,r,c;if(this.createNewElement)if(re((t=this.inputElement)===null||t===void 0?void 0:t.value,this.resultElements,this.currentSelections)){const f=X(((r=this.inputElement)===null||r===void 0?void 0:r.value)||"");this.createNewElement.value=((c=this.inputElement)===null||c===void 0?void 0:c.value)||"",this.createNewElement.innerHTML=this.highlightResults?`${this.addNewElementLabel} <span class="${A}">${f}</span>`:`${this.addNewElementLabel} ${f}`,this.resultElements.length&&this.resultElements[0].id!==w&&(this.createNewElement.isVisible=!0,this.resultElements.unshift(this.createNewElement))}else this.resultElements.length&&this.resultElements[0].id===w&&(this.createNewElement.isVisible=!1,this.resultElements.shift())}updateCurrentSelection(){var t;if(this.allowMultiple){const r=ae(this.value);this.currentSelections=r.map(c=>{var f;const b=this.resultElements.find(x=>x.value===c);if(b)return b.isSelected=!0,{text:((f=b.textContent)===null||f===void 0?void 0:f.trim())||"",value:b.value};{const x=D(c);return{text:x,value:x}}})}else{const r=this.resultElements.find(c=>c.value===this.value);if(r)this.currentSelections=[{text:((t=r.textContent)===null||t===void 0?void 0:t.trim())||"",value:r.value}];else{const c=D(this.value);this.currentSelections=[{text:c,value:c}]}}}updateGroupsVisibility(){this.resultGroups.length&&this.resultGroups.forEach(t=>{t.isVisible=this.resultElements.filter(r=>r.groupId===t.id).some(r=>r.isVisible&&!r.isSelected)})}updateInputValue(){this.inputElement&&(this.allowMultiple?this.inputElement.value="":this.inputElement.value=this.currentSelections.length?this.currentSelections[0].text:"")}render(){return _(H,{key:"99885bd32f065ecbd2003942d5c73b7be0dfdd63","aria-expanded":this.isOpen?"true":"false",class:`ods-combobox ods-combobox--${this.strategy}`,disabled:this.isDisabled,onBlur:t=>this.onBlur(t),readonly:this.isReadonly,role:"combobox"},_("div",{key:"e2d88ad6e42c51a2f75cb474fde8af29ef87b957",class:{"ods-combobox__search":!0,"ods-combobox__search--disabled":this.isDisabled,"ods-combobox__search--error":this.hasError||!!this.isInvalid,"ods-combobox__search--multiple":this.allowMultiple,"ods-combobox__search--read-only":this.isReadonly},ref:t=>t&&(this.searchElement=t)},this.allowMultiple&&this.currentSelections.length>0&&this.currentSelections.map(t=>_("ods-tag",{class:"ods-combobox__search__tag",isDisabled:this.isDisabled||this.isReadonly,label:t.text,onKeyDown:r=>this.onTagKeyDown(r),onOdsRemove:()=>this.onTagRemove(t.value),tabindex:"-1"})),_("ods-input",{key:"5e979c4803cc75864f2cde3b58dcf6584fe94796",class:"ods-combobox__search__input",isClearable:this.isClearable,isDisabled:this.isDisabled,isReadonly:this.isReadonly,isRequired:this.isRequired,isLoading:this.isLoading,name:this.name,onClick:()=>this.onInputClick(),onInput:()=>this.debouncedOnInput(),onKeyDown:t=>this.onInputKeyDown(t),onKeyUp:t=>this.onInputKeyUp(t),onOdsChange:t=>t.stopImmediatePropagation(),onOdsClear:t=>this.onInputClear(t),onOdsFocus:()=>this.onInputFocus(),onOdsInvalid:t=>t.stopImmediatePropagation(),placeholder:this.placeholder,ref:t=>this.inputElement=t})),_("ul",{key:"9613e95a0b5c4088954bf47b208ae47908641796",class:{"ods-combobox__results":!0,"ods-combobox__results--open":this.isOpen},ref:t=>t&&(this.resultListElement=t),role:"listbox",tabindex:"-1"},_("ods-combobox-item",{key:"32ce937c4d7b7387471345a4f1f72f9cd205b5c4",class:"ods-combobox__results__new",id:w,isVisible:!1,ref:t=>this.createNewElement=t,value:""}),this.hasNoResults&&_("li",{key:"4b00f71c40b6afc1c2d7d5f179948361aaf11f46",class:"ods-combobox__results__empty"},this.noResultLabel),_("slot",{key:"256797826b6631c97fefeb7b02d28cf8abcfe4b2",onSlotchange:t=>this.onSlotChange(t)})))}static get delegatesFocus(){return!0}static get formAssociated(){return!0}get el(){return this}static get watchers(){return{highlightResults:["onHighlightResultsChange"],isDisabled:["onIsDisabledChange"],isInvalid:["onIsInvalidChange"]}}static get style(){return pe}},[81,"ods-combobox",{addNewElementLabel:[513,"add-new-element-label"],allowMultiple:[516,"allow-multiple"],defaultValue:[513,"default-value"],hasError:[516,"has-error"],highlightResults:[516,"highlight-results"],isClearable:[516,"is-clearable"],isDisabled:[516,"is-disabled"],isLoading:[516,"is-loading"],isReadonly:[516,"is-readonly"],isRequired:[516,"is-required"],name:[513],noResultLabel:[513,"no-result-label"],placeholder:[513],strategy:[513],value:[1537],currentTagFocusedIndex:[32],hasNoResults:[32],isInvalid:[32],isOpen:[32],checkValidity:[64],clear:[64],close:[64],getValidationMessage:[64],getValidity:[64],open:[64],reportValidity:[64],reset:[64],willValidate:[64]},[[4,"click","onDocumentClick"],[4,"focusin","onDocumentFocusin"],[0,"invalid","onInvalidEvent"],[4,"keydown","onDocumentKeydown"],[0,"odsComboboxSelected","onOdsSwitchItemChange"]],{highlightResults:["onHighlightResultsChange"],isDisabled:["onIsDisabledChange"],isInvalid:["onIsInvalidChange"]}]);function be(){if(typeof customElements>"u")return;["ods-combobox","ods-button","ods-combobox-item","ods-icon","ods-input","ods-spinner","ods-tag"].forEach(t=>{switch(t){case"ods-combobox":customElements.get(t)||customElements.define(t,ve);break;case"ods-button":customElements.get(t)||Q();break;case"ods-combobox-item":customElements.get(t)||P();break;case"ods-icon":customElements.get(t)||ee();break;case"ods-input":customElements.get(t)||te();break;case"ods-spinner":customElements.get(t)||se();break;case"ods-tag":customElements.get(t)||ie();break}})}be();export{be as d};
