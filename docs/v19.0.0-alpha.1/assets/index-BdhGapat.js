import{g as d,a as E,b as L,i as T}from"./index-DDDhx9B2.js";function g(e){return e.mozInputSource===0&&e.isTrusted?!0:e.detail===0&&!e.pointerType}function F(e){return!(e.metaKey||!T()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}var M=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function H(e,r,n){const t=n?L(n):null,s=d(t);return e=e||t instanceof s.HTMLInputElement&&!M.has(t==null?void 0:t.type)||t instanceof s.HTMLTextAreaElement||t instanceof s.HTMLElement&&t.isContentEditable,!(e&&r==="keyboard"&&n instanceof s.KeyboardEvent&&!Reflect.has(K,n.key))}var u=null,v=new Set,a=new Map,i=!1,f=!1,K={Tab:!0,Escape:!0};function c(e,r){for(let n of v)n(e,r)}function l(e){i=!0,F(e)&&(u="keyboard",c("keyboard",e))}function o(e){u="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(i=!0,c("pointer",e))}function b(e){g(e)&&(i=!0,u="virtual")}function w(e){const r=L(e);r===d(r)||r===E(r)||(!i&&!f&&(u="virtual",c("virtual",e)),i=!1,f=!1)}function k(){i=!1,f=!0}function S(e){if(typeof window>"u"||a.get(d(e)))return;const r=d(e),n=E(e);let t=r.HTMLElement.prototype.focus;r.HTMLElement.prototype.focus=function(){u="virtual",c("virtual",null),i=!0,t.apply(this,arguments)},n.addEventListener("keydown",l,!0),n.addEventListener("keyup",l,!0),n.addEventListener("click",b,!0),r.addEventListener("focus",w,!0),r.addEventListener("blur",k,!1),typeof r.PointerEvent<"u"?(n.addEventListener("pointerdown",o,!0),n.addEventListener("pointermove",o,!0),n.addEventListener("pointerup",o,!0)):(n.addEventListener("mousedown",o,!0),n.addEventListener("mousemove",o,!0),n.addEventListener("mouseup",o,!0)),r.addEventListener("beforeunload",()=>{V(e)},{once:!0}),a.set(r,{focus:t})}var V=(e,r)=>{const n=d(e),t=E(e);a.has(n)&&(n.HTMLElement.prototype.focus=a.get(n).focus,t.removeEventListener("keydown",l,!0),t.removeEventListener("keyup",l,!0),t.removeEventListener("click",b,!0),n.removeEventListener("focus",w,!0),n.removeEventListener("blur",k,!1),typeof n.PointerEvent<"u"?(t.removeEventListener("pointerdown",o,!0),t.removeEventListener("pointermove",o,!0),t.removeEventListener("pointerup",o,!0)):(t.removeEventListener("mousedown",o,!0),t.removeEventListener("mousemove",o,!0),t.removeEventListener("mouseup",o,!0)),a.delete(n))};function y(){return u==="keyboard"}function B(e={}){const{isTextInput:r,autoFocus:n,onChange:t,root:s}=e;S(s),t==null||t({isFocusVisible:n||y(),modality:u});const p=(m,h)=>{H(!!r,m,h)&&(t==null||t({isFocusVisible:y(),modality:m}))};return v.add(p),()=>{v.delete(p)}}export{y as i,B as t};
