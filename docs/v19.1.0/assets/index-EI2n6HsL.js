import{r as B,b as T,g as U,f as V,l as x,m as C,d as O,n as N,o as H,p as $,q as S,s as I,t as M,v as j,w as z,x as G,y as J}from"./use-locale-context-DLC4Hyvy.js";function Q(t){const e={each(n){var r;for(let i=0;i<((r=t.frames)==null?void 0:r.length);i+=1){const s=t.frames[i];s&&n(s)}},addEventListener(n,r,i){return e.each(s=>{try{s.document.addEventListener(n,r,i)}catch{}}),()=>{try{e.removeEventListener(n,r,i)}catch{}}},removeEventListener(n,r,i){e.each(s=>{try{s.document.removeEventListener(n,r,i)}catch{}})}};return e}function Z(t){const e=t.frameElement!=null?t.parent:null;return{addEventListener:(n,r,i)=>{try{e==null||e.addEventListener(n,r,i)}catch{}return()=>{try{e==null||e.removeEventListener(n,r,i)}catch{}}},removeEventListener:(n,r,i)=>{try{e==null||e.removeEventListener(n,r,i)}catch{}}}}var W="pointerdown.outside",F="focus.outside";function ee(t){for(const e of t)if(S(e)&&H(e))return!0;return!1}var q=t=>"clientY"in t;function te(t,e){if(!q(e)||!t)return!1;const n=t.getBoundingClientRect();return n.width===0||n.height===0?!1:n.top<=e.clientY&&e.clientY<=n.top+n.height&&n.left<=e.clientX&&e.clientX<=n.left+n.width}function ne(t,e){return t.y<=e.y&&e.y<=t.y+t.height&&t.x<=e.x&&e.x<=t.x+t.width}function Y(t,e){if(!e||!q(t))return!1;const n=e.scrollHeight>e.clientHeight,r=n&&t.clientX>e.offsetLeft+e.clientWidth,i=e.scrollWidth>e.clientWidth,s=i&&t.clientY>e.offsetTop+e.clientHeight,g={x:e.offsetLeft,y:e.offsetTop,width:e.clientWidth+(n?16:0),height:e.clientHeight+(i?16:0)},E={x:t.clientX,y:t.clientY};return ne(g,E)?r||s:!1}function re(t,e){const{exclude:n,onFocusOutside:r,onPointerDownOutside:i,onInteractOutside:s,defer:g}=e;if(!t)return;const E=T(t),p=U(t),w=Q(p),L=Z(p);function P(o,y){if(!S(y)||!y.isConnected||I(t,y)||te(t,o))return!1;const l=E.querySelector(`[aria-controls="${t.id}"]`);if(l){const d=M(l);if(Y(o,d))return!1}const v=M(t);return Y(o,v)?!1:!(n!=null&&n(y))}const m=new Set,c=V(t==null?void 0:t.getRootNode());function u(o){function y(l){var A;const v=g&&!C()?B:k=>k(),d=l??o,D=((A=d==null?void 0:d.composedPath)==null?void 0:A.call(d))??[d==null?void 0:d.target];v(()=>{const k=c?D[0]:O(o);if(!(!t||!P(o,k))){if(i||s){const K=N(i,s);t.addEventListener(W,K,{once:!0})}_(t,W,{bubbles:!1,cancelable:!0,detail:{originalEvent:d,contextmenu:$(d),focusable:ee(D),target:k}})}})}o.pointerType==="touch"?(m.forEach(l=>l()),m.add(x(E,"click",y,{once:!0})),m.add(L.addEventListener("click",y,{once:!0})),m.add(w.addEventListener("click",y,{once:!0}))):y()}const a=new Set,h=setTimeout(()=>{a.add(x(E,"pointerdown",u,!0)),a.add(L.addEventListener("pointerdown",u,!0)),a.add(w.addEventListener("pointerdown",u,!0))},0);function b(o){(g?B:l=>l())(()=>{const l=O(o);if(!(!t||!P(o,l))){if(r||s){const v=N(r,s);t.addEventListener(F,v,{once:!0})}_(t,F,{bubbles:!1,cancelable:!0,detail:{originalEvent:o,contextmenu:!1,focusable:H(l),target:l}})}})}return C()||(a.add(x(E,"focusin",b,!0)),a.add(L.addEventListener("focusin",b,!0)),a.add(w.addEventListener("focusin",b,!0))),()=>{clearTimeout(h),m.forEach(o=>o()),a.forEach(o=>o())}}function ie(t,e){const{defer:n}=e,r=n?B:s=>s(),i=[];return i.push(r(()=>{const s=typeof t=="function"?t():t;i.push(re(s,e))})),()=>{i.forEach(s=>s==null?void 0:s())}}function _(t,e,n){const r=t.ownerDocument.defaultView||window,i=new r.CustomEvent(e,n);return t.dispatchEvent(i)}function se(t,e){const n=r=>{r.key==="Escape"&&(r.isComposing||e==null||e(r))};return x(T(t),"keydown",n,{capture:!0})}var f={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(t=>t.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(t){var r;const e=this.indexOf(t),n=this.topMostPointerBlockingLayer()?this.indexOf((r=this.topMostPointerBlockingLayer())==null?void 0:r.node):-1;return e<n},isTopMost(t){const e=this.layers[this.count()-1];return(e==null?void 0:e.node)===t},getNestedLayers(t){return Array.from(this.layers).slice(this.indexOf(t)+1)},isInNestedLayer(t,e){return this.getNestedLayers(t).some(n=>I(n.node,e))},isInBranch(t){return Array.from(this.branches).some(e=>I(e,t))},add(t){const e=this.layers.push(t);t.node.style.setProperty("--layer-index",`${e}`)},addBranch(t){this.branches.push(t)},remove(t){const e=this.indexOf(t);e<0||(e<this.count()-1&&this.getNestedLayers(t).forEach(r=>r.dismiss()),this.layers.splice(e,1),t.style.removeProperty("--layer-index"))},removeBranch(t){const e=this.branches.indexOf(t);e>=0&&this.branches.splice(e,1)},indexOf(t){return this.layers.findIndex(e=>e.node===t)},dismiss(t){var e;(e=this.layers[this.indexOf(t)])==null||e.dismiss()},clear(){this.remove(this.layers[0].node)}},R;function X(){f.layers.forEach(({node:t})=>{t.style.pointerEvents=f.isBelowPointerBlockingLayer(t)?"none":"auto"})}function ce(t){t.style.pointerEvents=""}function oe(t,e){const n=T(t),r=[];if(f.hasPointerBlockingLayer()&&!n.body.hasAttribute("data-inert")&&(R=document.body.style.pointerEvents,queueMicrotask(()=>{n.body.style.pointerEvents="none",n.body.setAttribute("data-inert","")})),e){const i=G(e,s=>{r.push(J(s,{pointerEvents:"auto"}))});r.push(i)}return()=>{f.hasPointerBlockingLayer()||(queueMicrotask(()=>{n.body.style.pointerEvents=R,n.body.removeAttribute("data-inert"),n.body.style.length===0&&n.body.removeAttribute("style")}),r.forEach(i=>i()))}}function ae(t,e){const{warnOnMissingNode:n=!0}=e;if(n&&!t){z("[@zag-js/dismissable] node is `null` or `undefined`");return}if(!t)return;const{onDismiss:r,pointerBlocking:i,exclude:s,debug:g}=e,E={dismiss:r,node:t,pointerBlocking:i};f.add(E),X();function p(c){var a,h;const u=O(c.detail.originalEvent);f.isBelowPointerBlockingLayer(t)||f.isInBranch(u)||((a=e.onPointerDownOutside)==null||a.call(e,c),(h=e.onInteractOutside)==null||h.call(e,c),!c.defaultPrevented&&(g&&console.log("onPointerDownOutside:",c.detail.originalEvent),r==null||r()))}function w(c){var a,h;const u=O(c.detail.originalEvent);f.isInBranch(u)||((a=e.onFocusOutside)==null||a.call(e,c),(h=e.onInteractOutside)==null||h.call(e,c),!c.defaultPrevented&&(g&&console.log("onFocusOutside:",c.detail.originalEvent),r==null||r()))}function L(c){var u;f.isTopMost(t)&&((u=e.onEscapeKeyDown)==null||u.call(e,c),!c.defaultPrevented&&r&&(c.preventDefault(),r()))}function P(c){var b;if(!t)return!1;const u=typeof s=="function"?s():s,a=Array.isArray(u)?u:[u],h=(b=e.persistentElements)==null?void 0:b.map(o=>o()).filter(S);return h&&a.push(...h),a.some(o=>I(o,c))||f.isInNestedLayer(t,c)}const m=[i?oe(t,e.persistentElements):void 0,se(t,L),ie(t,{exclude:P,onFocusOutside:w,onPointerDownOutside:p,defer:e.defer})];return()=>{f.remove(t),X(),ce(t),m.forEach(c=>c==null?void 0:c())}}function le(t,e){const{defer:n}=e,r=n?B:s=>s(),i=[];return i.push(r(()=>{const s=j(t)?t():t;i.push(ae(s,e))})),()=>{i.forEach(s=>s==null?void 0:s())}}export{le as t};
