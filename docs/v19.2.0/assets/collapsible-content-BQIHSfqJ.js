import{j as b}from"./jsx-runtime-Cfl8ynUo.js";import{r as C}from"./index-jIWwRBLr.js";import{a as N,z as I,r as v,P as h,Q as R,B as y,y as z,d as E,A as S,C as w,R as A,u as j,D as L,S as M,c as T,T as x,U as k}from"./use-locale-context-BIV2aQtl.js";const V=e=>N()(e,["defaultOpen","disabled","id","ids","lazyMount","onExitComplete","onOpenChange","open","unmountOnExit"]);var $=R("collapsible").parts("root","trigger","content","indicator"),m=$.build(),B=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`collapsible:${e.id}`},O=e=>{var t;return((t=e.ids)==null?void 0:t.content)??`collapsible:${e.id}:content`},D=e=>{var t;return((t=e.ids)==null?void 0:t.trigger)??`collapsible:${e.id}:trigger`},g=e=>e.getById(O(e));function U(e,t){const{state:n,send:a,context:i,scope:o,prop:c}=e,s=n.matches("open")||n.matches("closing"),l=n.matches("open"),{width:d,height:r}=i.get("size"),p=!!c("disabled"),P=!i.get("initial")&&l,f="ltr";return{disabled:p,visible:s,open:l,measureSize(){a({type:"size.measure"})},setOpen(u){n.matches("open")!==u&&a({type:u?"open":"close"})},getRootProps(){return t.element({...m.root.attrs,"data-state":l?"open":"closed",dir:f,id:B(o)})},getContentProps(){return t.element({...m.content.attrs,"data-collapsible":"","data-state":P?void 0:l?"open":"closed",id:O(o),"data-disabled":h(p),hidden:!s,style:{"--height":r!=null?`${r}px`:void 0,"--width":d!=null?`${d}px`:void 0}})},getTriggerProps(){return t.element({...m.trigger.attrs,id:D(o),dir:f,type:"button","data-state":l?"open":"closed","data-disabled":h(p),"aria-controls":O(o),"aria-expanded":s||!1,onClick(u){u.defaultPrevented||p||a({type:l?"close":"open"})}})},getIndicatorProps(){return t.element({...m.indicator.attrs,dir:f,"data-state":l?"open":"closed","data-disabled":h(p)})}}}var F=I({initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{size:e(()=>({defaultValue:{height:0,width:0},sync:!0})),initial:e(()=>({defaultValue:!1}))}},refs(){return{cleanup:void 0,stylesRef:void 0}},watch({track:e,prop:t,action:n}){e([()=>t("open")],()=>{n(["setInitial","computeSize","toggleVisibility"])})},exit:["clearInitial","cleanupNode"],states:{closed:{on:{"controlled.open":{target:"open"},open:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["setInitial","computeSize","invokeOnOpen"]}]}},closing:{effects:["trackExitAnimation"],on:{"controlled.close":{target:"closed"},"controlled.open":{target:"open"},open:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["setInitial","invokeOnOpen"]}],close:[{guard:"isOpenControlled",actions:["invokeOnExitComplete"]},{target:"closed",actions:["setInitial","computeSize","invokeOnExitComplete"]}],"animation.end":{target:"closed",actions:["invokeOnExitComplete","clearInitial"]}}},open:{effects:["trackEnterAnimation"],on:{"controlled.close":{target:"closing"},close:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closing",actions:["setInitial","computeSize","invokeOnClose"]}],"size.measure":{actions:["measureSize"]},"animation.end":{actions:["clearInitial"]}}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackEnterAnimation:({send:e,scope:t})=>{let n;const a=v(()=>{const i=g(t);if(!i)return;const o=y(i).animationName;if(!o||o==="none"){e({type:"animation.end"});return}const s=l=>{E(l)===i&&e({type:"animation.end"})};i.addEventListener("animationend",s),n=()=>{i.removeEventListener("animationend",s)}});return()=>{a(),n==null||n()}},trackExitAnimation:({send:e,scope:t})=>{let n;const a=v(()=>{const i=g(t);if(!i)return;const o=y(i).animationName;if(!o||o==="none"){e({type:"animation.end"});return}const s=d=>{E(d)===i&&e({type:"animation.end"})};i.addEventListener("animationend",s);const l=z(i,{animationFillMode:"forwards"});n=()=>{i.removeEventListener("animationend",s),S(()=>l())}});return()=>{a(),n==null||n()}}},actions:{setInitial:({context:e,flush:t})=>{t(()=>{e.set("initial",!0)})},clearInitial:({context:e})=>{e.set("initial",!1)},cleanupNode:({refs:e})=>{e.set("stylesRef",null)},measureSize:({context:e,scope:t})=>{const n=g(t);if(!n)return;const{height:a,width:i}=n.getBoundingClientRect();e.set("size",{height:a,width:i})},computeSize:({refs:e,scope:t,context:n})=>{var i;(i=e.get("cleanup"))==null||i();const a=v(()=>{const o=g(t);if(!o)return;const c=o.hidden;o.style.animationName="none",o.style.animationDuration="0s",o.hidden=!1;const s=o.getBoundingClientRect();n.set("size",{height:s.height,width:s.width}),n.get("initial")&&(o.style.animationName="",o.style.animationDuration=""),o.hidden=c});e.set("cleanup",a)},invokeOnOpen:({prop:e})=>{var t;(t=e("onOpenChange"))==null||t({open:!0})},invokeOnClose:({prop:e})=>{var t;(t=e("onOpenChange"))==null||t({open:!1})},invokeOnExitComplete:({prop:e})=>{var t;(t=e("onExitComplete"))==null||t()},toggleVisibility:({prop:e,send:t})=>{t({type:e("open")?"controlled.open":"controlled.close"})}}}});w()(["dir","disabled","getRootNode","id","ids","onExitComplete","onOpenChange","defaultOpen","open"]);const Q=(e={})=>{const{lazyMount:t,unmountOnExit:n,...a}=e,i=C.useId(),o=C.useRef(!1),{dir:c}=A(),{getRootNode:s}=j(),l={id:i,dir:c,getRootNode:s,...a},d=L(F,l),r=U(d,M);r.visible&&(o.current=!0);const p=!r.visible&&!o.current&&t||n&&!r.visible&&o.current;return{...r,isUnmounted:p}},[q,G]=T({name:"CollapsibleContext",hookName:"useCollapsibleContext",providerName:"<CollapsibleProvider />"}),H=C.forwardRef((e,t)=>{const[n,a]=V(e),i=Q(n),o=x(i.getRootProps(),a);return b.jsx(q,{value:i,children:b.jsx(k.div,{...o,ref:t})})});H.displayName="CollapsibleRoot";const J=C.forwardRef((e,t)=>{const n=G();if(n.isUnmounted)return null;const a=x(n.getContentProps(),e);return b.jsx(k.div,{...a,ref:t})});J.displayName="CollapsibleContent";export{H as C,J as a,G as u};
