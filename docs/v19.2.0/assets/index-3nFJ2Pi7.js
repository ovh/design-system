import{r as P,b as S,g as U,k as $,l as O,m as N,d as k,n as C,o as H,p as j,q as T,s as B,t as M,v as z,w as Q,x as G,y as J}from"./use-locale-context-BIV2aQtl.js";function Z(e){const t={each(n){var r;for(let s=0;s<((r=e.frames)==null?void 0:r.length);s+=1){const i=e.frames[s];i&&n(i)}},addEventListener(n,r,s){return t.each(i=>{try{i.document.addEventListener(n,r,s)}catch{}}),()=>{try{t.removeEventListener(n,r,s)}catch{}}},removeEventListener(n,r,s){t.each(i=>{try{i.document.removeEventListener(n,r,s)}catch{}})}};return t}function ee(e){const t=e.frameElement!=null?e.parent:null;return{addEventListener:(n,r,s)=>{try{t==null||t.addEventListener(n,r,s)}catch{}return()=>{try{t==null||t.removeEventListener(n,r,s)}catch{}}},removeEventListener:(n,r,s)=>{try{t==null||t.removeEventListener(n,r,s)}catch{}}}}var W="pointerdown.outside",_="focus.outside";function te(e){for(const t of e)if(T(t)&&H(t))return!0;return!1}var V=e=>"clientY"in e;function ne(e,t){if(!V(t)||!e)return!1;const n=e.getBoundingClientRect();return n.width===0||n.height===0?!1:n.top<=t.clientY&&t.clientY<=n.top+n.height&&n.left<=t.clientX&&t.clientX<=n.left+n.width}function re(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function R(e,t){if(!t||!V(e))return!1;const n=t.scrollHeight>t.clientHeight,r=n&&e.clientX>t.offsetLeft+t.clientWidth,s=t.scrollWidth>t.clientWidth,i=s&&e.clientY>t.offsetTop+t.clientHeight,E={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(n?16:0),height:t.clientHeight+(s?16:0)},u={x:e.clientX,y:e.clientY};return re(E,u)?r||i:!1}function se(e,t){const{exclude:n,onFocusOutside:r,onPointerDownOutside:s,onInteractOutside:i,defer:E}=t;if(!e)return;const u=S(e),p=U(e),m=Z(p),L=ee(p);function w(c,d){if(!T(d)||!d.isConnected||B(e,d)||ne(e,c))return!1;const a=u.querySelector(`[aria-controls="${e.id}"]`);if(a){const h=M(a);if(R(c,h))return!1}const v=M(e);return R(c,v)?!1:!(n!=null&&n(d))}const g=new Set,I=$(e==null?void 0:e.getRootNode());function b(c){function d(a){var A;const v=E&&!N()?P:x=>x(),h=a??c,D=((A=h==null?void 0:h.composedPath)==null?void 0:A.call(h))??[h==null?void 0:h.target];v(()=>{const x=I?D[0]:k(c);if(!(!e||!w(c,x))){if(s||i){const K=C(s,i);e.addEventListener(W,K,{once:!0})}q(e,W,{bubbles:!1,cancelable:!0,detail:{originalEvent:h,contextmenu:j(h),focusable:te(D),target:x}})}})}c.pointerType==="touch"?(g.forEach(a=>a()),g.add(O(u,"click",d,{once:!0})),g.add(L.addEventListener("click",d,{once:!0})),g.add(m.addEventListener("click",d,{once:!0}))):d()}const o=new Set,l=setTimeout(()=>{o.add(O(u,"pointerdown",b,!0)),o.add(L.addEventListener("pointerdown",b,!0)),o.add(m.addEventListener("pointerdown",b,!0))},0);function f(c){(E?P:a=>a())(()=>{const a=k(c);if(!(!e||!w(c,a))){if(r||i){const v=C(r,i);e.addEventListener(_,v,{once:!0})}q(e,_,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:!1,focusable:H(a),target:a}})}})}return N()||(o.add(O(u,"focusin",f,!0)),o.add(L.addEventListener("focusin",f,!0)),o.add(m.addEventListener("focusin",f,!0))),()=>{clearTimeout(l),g.forEach(c=>c()),o.forEach(c=>c())}}function ie(e,t){const{defer:n}=t,r=n?P:i=>i(),s=[];return s.push(r(()=>{const i=typeof e=="function"?e():e;s.push(se(i,t))})),()=>{s.forEach(i=>i==null?void 0:i())}}function q(e,t,n){const r=e.ownerDocument.defaultView||window,s=new r.CustomEvent(t,n);return e.dispatchEvent(s)}function oe(e,t){const n=r=>{r.key==="Escape"&&(r.isComposing||t==null||t(r))};return O(S(e),"keydown",n,{capture:!0})}var Y="layer:request-dismiss",y={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(e=>e.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(e){var r;const t=this.indexOf(e),n=this.topMostPointerBlockingLayer()?this.indexOf((r=this.topMostPointerBlockingLayer())==null?void 0:r.node):-1;return t<n},isTopMost(e){const t=this.layers[this.count()-1];return(t==null?void 0:t.node)===e},getNestedLayers(e){return Array.from(this.layers).slice(this.indexOf(e)+1)},getLayersByType(e){return this.layers.filter(t=>t.type===e)},getNestedLayersByType(e,t){const n=this.indexOf(e);return n===-1?[]:this.layers.slice(n+1).filter(r=>r.type===t)},getParentLayerOfType(e,t){const n=this.indexOf(e);if(!(n<=0))return this.layers.slice(0,n).reverse().find(r=>r.type===t)},countNestedLayersOfType(e,t){return this.getNestedLayersByType(e,t).length},isInNestedLayer(e,t){return this.getNestedLayers(e).some(n=>B(n.node,t))},isInBranch(e){return Array.from(this.branches).some(t=>B(t,e))},add(e){this.layers.push(e),this.syncLayers()},addBranch(e){this.branches.push(e)},remove(e){const t=this.indexOf(e);t<0||(t<this.count()-1&&this.getNestedLayers(e).forEach(r=>y.dismiss(r.node,e)),this.layers.splice(t,1),this.syncLayers())},removeBranch(e){const t=this.branches.indexOf(e);t>=0&&this.branches.splice(t,1)},syncLayers(){this.layers.forEach((e,t)=>{e.node.style.setProperty("--layer-index",`${t}`),e.node.removeAttribute("data-nested"),e.node.removeAttribute("data-has-nested"),this.getParentLayerOfType(e.node,e.type)&&e.node.setAttribute("data-nested",e.type);const r=this.countNestedLayersOfType(e.node,e.type);r>0&&e.node.setAttribute("data-has-nested",e.type),e.node.style.setProperty("--nested-layer-count",`${r}`)})},indexOf(e){return this.layers.findIndex(t=>t.node===e)},dismiss(e,t){const n=this.indexOf(e);if(n===-1)return;const r=this.layers[n];ae(e,Y,s=>{var i;(i=r.requestDismiss)==null||i.call(r,s),s.defaultPrevented||r==null||r.dismiss()}),ce(e,Y,{originalLayer:e,targetLayer:t,originalIndex:n,targetIndex:t?this.indexOf(t):-1}),this.syncLayers()},clear(){this.remove(this.layers[0].node)}};function ce(e,t,n){const r=e.ownerDocument.defaultView||window,s=new r.CustomEvent(t,{cancelable:!0,bubbles:!0,detail:n});return e.dispatchEvent(s)}function ae(e,t,n){e.addEventListener(t,n,{once:!0})}var F;function X(){y.layers.forEach(({node:e})=>{e.style.pointerEvents=y.isBelowPointerBlockingLayer(e)?"none":"auto"})}function ue(e){e.style.pointerEvents=""}function de(e,t){const n=S(e),r=[];return y.hasPointerBlockingLayer()&&!n.body.hasAttribute("data-inert")&&(F=document.body.style.pointerEvents,queueMicrotask(()=>{n.body.style.pointerEvents="none",n.body.setAttribute("data-inert","")})),t==null||t.forEach(s=>{const[i,E]=G(()=>{const u=s();return T(u)?u:null},{timeout:1e3});i.then(u=>r.push(J(u,{pointerEvents:"auto"}))),r.push(E)}),()=>{y.hasPointerBlockingLayer()||(queueMicrotask(()=>{n.body.style.pointerEvents=F,n.body.removeAttribute("data-inert"),n.body.style.length===0&&n.body.removeAttribute("style")}),r.forEach(s=>s()))}}function le(e,t){const{warnOnMissingNode:n=!0}=t;if(n&&!e){Q("[@zag-js/dismissable] node is `null` or `undefined`");return}if(!e)return;const{onDismiss:r,onRequestDismiss:s,pointerBlocking:i,exclude:E,debug:u,type:p="dialog"}=t,m={dismiss:r,node:e,type:p,pointerBlocking:i,requestDismiss:s};y.add(m),X();function L(o){var f,c;const l=k(o.detail.originalEvent);y.isBelowPointerBlockingLayer(e)||y.isInBranch(l)||((f=t.onPointerDownOutside)==null||f.call(t,o),(c=t.onInteractOutside)==null||c.call(t,o),!o.defaultPrevented&&(u&&console.log("onPointerDownOutside:",o.detail.originalEvent),r==null||r()))}function w(o){var f,c;const l=k(o.detail.originalEvent);y.isInBranch(l)||((f=t.onFocusOutside)==null||f.call(t,o),(c=t.onInteractOutside)==null||c.call(t,o),!o.defaultPrevented&&(u&&console.log("onFocusOutside:",o.detail.originalEvent),r==null||r()))}function g(o){var l;y.isTopMost(e)&&((l=t.onEscapeKeyDown)==null||l.call(t,o),!o.defaultPrevented&&r&&(o.preventDefault(),r()))}function I(o){var d;if(!e)return!1;const l=typeof E=="function"?E():E,f=Array.isArray(l)?l:[l],c=(d=t.persistentElements)==null?void 0:d.map(a=>a()).filter(T);return c&&f.push(...c),f.some(a=>B(a,o))||y.isInNestedLayer(e,o)}const b=[i?de(e,t.persistentElements):void 0,oe(e,g),ie(e,{exclude:I,onFocusOutside:w,onPointerDownOutside:L,defer:t.defer})];return()=>{y.remove(e),X(),ue(e),b.forEach(o=>o==null?void 0:o())}}function he(e,t){const{defer:n}=t,r=n?P:i=>i(),s=[];return s.push(r(()=>{const i=z(e)?e():e;s.push(le(i,t))})),()=>{s.forEach(i=>i==null?void 0:i())}}export{he as t};
