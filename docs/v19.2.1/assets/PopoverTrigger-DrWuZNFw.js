import{j as p}from"./jsx-runtime-Cfl8ynUo.js";import{a as H}from"./overlay-CZHjGBMC.js";import{s as Y,P as Q}from"./portal-QnUqvOWs.js";import{u as w,a as X,P as J}from"./use-presence-BC2E-XtL.js";import{c as Z,T as h,U as E,V as z,z as ee,r as C,ab as te,Q as oe,P as re,a7 as ne,X as se,ac as N,C as ie,u as ae,R as de,D as pe,S as ce}from"./use-locale-context-BIV2aQtl.js";import{a as R,g as le}from"./index-Bc-ZgdcL.js";import{t as ue,p as ge,a as me}from"./index-RANsh8_O.js";import{t as ve}from"./index-3nFJ2Pi7.js";import{r as a}from"./index-jIWwRBLr.js";import{c as S}from"./index-CqY9YpN0.js";const[fe,y]=Z({name:"PopoverContext",hookName:"usePopoverContext",providerName:"<PopoverProvider />"}),L=a.forwardRef((e,t)=>{const o=y(),r=h(o.getArrowProps(),e);return p.jsx(E.div,{...r,ref:t})});L.displayName="PopoverArrow";const j=a.forwardRef((e,t)=>{const o=y(),r=h(o.getArrowTipProps(),e);return p.jsx(E.div,{...r,ref:t})});j.displayName="PopoverArrowTip";const _=a.forwardRef((e,t)=>{const o=y(),r=w(),n=h(o.getContentProps(),r.getPresenceProps(),e);return r.unmounted?null:p.jsx(E.div,{...n,ref:z(r.ref,t)})});_.displayName="PopoverContent";const A=a.forwardRef((e,t)=>{const o=y(),r=w(),n=h(o.getPositionerProps(),e);return r.unmounted?null:p.jsx(E.div,{...n,ref:t})});A.displayName="PopoverPositioner";var Pe=oe("popover").parts("arrow","arrowTip","anchor","trigger","indicator","positioner","content","title","description","closeTrigger"),g=Pe.build(),q=e=>{var t;return((t=e.ids)==null?void 0:t.anchor)??`popover:${e.id}:anchor`},$=e=>{var t;return((t=e.ids)==null?void 0:t.trigger)??`popover:${e.id}:trigger`},T=e=>{var t;return((t=e.ids)==null?void 0:t.content)??`popover:${e.id}:content`},B=e=>{var t;return((t=e.ids)==null?void 0:t.positioner)??`popover:${e.id}:popper`},he=e=>{var t;return((t=e.ids)==null?void 0:t.arrow)??`popover:${e.id}:arrow`},I=e=>{var t;return((t=e.ids)==null?void 0:t.title)??`popover:${e.id}:title`},b=e=>{var t;return((t=e.ids)==null?void 0:t.description)??`popover:${e.id}:desc`},Oe=e=>{var t;return((t=e.ids)==null?void 0:t.closeTrigger)??`popover:${e.id}:close`},D=e=>e.getById(q(e)),f=e=>e.getById($(e)),P=e=>e.getById(T(e)),k=e=>e.getById(B(e)),Ee=e=>e.getById(I(e)),ye=e=>e.getById(b(e));function Ce(e,t){const{state:o,context:r,send:n,computed:s,prop:i,scope:c}=e,l=o.matches("open"),m=r.get("currentPlacement"),u=s("currentPortalled"),O=r.get("renderedElements"),v=le({...i("positioning"),placement:m});return{portalled:u,open:l,setOpen(d){o.matches("open")!==d&&n({type:d?"OPEN":"CLOSE"})},reposition(d={}){n({type:"POSITIONING.SET",options:d})},getArrowProps(){return t.element({id:he(c),...g.arrow.attrs,dir:i("dir"),style:v.arrow})},getArrowTipProps(){return t.element({...g.arrowTip.attrs,dir:i("dir"),style:v.arrowTip})},getAnchorProps(){return t.element({...g.anchor.attrs,dir:i("dir"),id:q(c)})},getTriggerProps(){return t.button({...g.trigger.attrs,dir:i("dir"),type:"button","data-placement":m,id:$(c),"aria-haspopup":"dialog","aria-expanded":l,"data-state":l?"open":"closed","aria-controls":T(c),onPointerDown(d){ne(d)&&se()&&d.currentTarget.focus()},onClick(d){d.defaultPrevented||n({type:"TOGGLE"})},onBlur(d){n({type:"TRIGGER_BLUR",target:d.relatedTarget})}})},getIndicatorProps(){return t.element({...g.indicator.attrs,dir:i("dir"),"data-state":l?"open":"closed"})},getPositionerProps(){return t.element({id:B(c),...g.positioner.attrs,dir:i("dir"),style:v.floating})},getContentProps(){return t.element({...g.content.attrs,dir:i("dir"),id:T(c),tabIndex:-1,role:"dialog",hidden:!l,"data-state":l?"open":"closed","data-expanded":re(l),"aria-labelledby":O.title?I(c):void 0,"aria-describedby":O.description?b(c):void 0,"data-placement":m})},getTitleProps(){return t.element({...g.title.attrs,id:I(c),dir:i("dir")})},getDescriptionProps(){return t.element({...g.description.attrs,id:b(c),dir:i("dir")})},getCloseTriggerProps(){return t.button({...g.closeTrigger.attrs,dir:i("dir"),id:Oe(c),type:"button","aria-label":"close",onClick(d){d.defaultPrevented||(d.stopPropagation(),n({type:"CLOSE"}))}})}}}var Te=ee({props({props:e}){return{closeOnInteractOutside:!0,closeOnEscape:!0,autoFocus:!0,modal:!1,portalled:!0,...e,positioning:{placement:"bottom",...e.positioning}}},initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{currentPlacement:e(()=>({defaultValue:void 0})),renderedElements:e(()=>({defaultValue:{title:!0,description:!0}}))}},computed:{currentPortalled:({prop:e})=>!!e("modal")||!!e("portalled")},watch({track:e,prop:t,action:o}){e([()=>t("open")],()=>{o(["toggleVisibility"])})},entry:["checkRenderedElements"],states:{closed:{on:{"CONTROLLED.OPEN":{target:"open",actions:["setInitialFocus"]},TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}],OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}]}},open:{effects:["trapFocus","preventScroll","hideContentBelow","trackPositioning","trackDismissableElement","proxyTabFocus"],on:{"CONTROLLED.CLOSE":{target:"closed",actions:["setFinalFocus"]},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],"POSITIONING.SET":{actions:["reposition"]}}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackPositioning({context:e,prop:t,scope:o}){e.set("currentPlacement",t("positioning").placement);const r=D(o)??f(o);return R(r,()=>k(o),{...t("positioning"),defer:!0,onComplete(s){e.set("currentPlacement",s.placement)}})},trackDismissableElement({send:e,prop:t,scope:o}){const r=()=>P(o);let n=!0;return ve(r,{type:"popover",pointerBlocking:t("modal"),exclude:f(o),defer:!0,onEscapeKeyDown(s){var i;(i=t("onEscapeKeyDown"))==null||i(s),!t("closeOnEscape")&&s.preventDefault()},onInteractOutside(s){var i;(i=t("onInteractOutside"))==null||i(s),!s.defaultPrevented&&(n=!(s.detail.focusable||s.detail.contextmenu),t("closeOnInteractOutside")||s.preventDefault())},onPointerDownOutside:t("onPointerDownOutside"),onFocusOutside:t("onFocusOutside"),persistentElements:t("persistentElements"),onRequestDismiss:t("onRequestDismiss"),onDismiss(){e({type:"CLOSE",src:"interact-outside",restoreFocus:n})}})},proxyTabFocus({prop:e,scope:t}){return e("modal")||!e("portalled")?void 0:te(()=>P(t),{triggerElement:f(t),defer:!0,onFocus(r){r.focus({preventScroll:!0})}})},hideContentBelow({prop:e,scope:t}){return e("modal")?me(()=>[P(t),f(t)],{defer:!0}):void 0},preventScroll({prop:e,scope:t}){if(e("modal"))return ge(t.getDoc())},trapFocus({prop:e,scope:t}){return e("modal")?ue(()=>P(t),{initialFocus:()=>N({root:P(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")})}):void 0}},actions:{reposition({event:e,prop:t,scope:o,context:r}){const n=D(o)??f(o);R(n,()=>k(o),{...t("positioning"),...e.options,defer:!0,listeners:!1,onComplete(i){r.set("currentPlacement",i.placement)}})},checkRenderedElements({context:e,scope:t}){C(()=>{Object.assign(e.get("renderedElements"),{title:!!Ee(t),description:!!ye(t)})})},setInitialFocus({prop:e,scope:t}){e("modal")||C(()=>{const o=N({root:P(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")});o==null||o.focus({preventScroll:!0})})},setFinalFocus({event:e,scope:t}){var r;const o=e.restoreFocus??((r=e.previousEvent)==null?void 0:r.restoreFocus);o!=null&&!o||C(()=>{const n=f(t);n==null||n.focus({preventScroll:!0})})},invokeOnOpen({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!0})})},invokeOnClose({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!1})})},toggleVisibility({event:e,send:t,prop:o}){t({type:o("open")?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:e})}}}});ie()(["autoFocus","closeOnEscape","closeOnInteractOutside","dir","getRootNode","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","onRequestDismiss","defaultOpen","open","persistentElements","portalled","positioning"]);const Ie=e=>{const t=a.useId(),{getRootNode:o}=ae(),{dir:r}=de(),n={id:t,dir:r,getRootNode:o,...e},s=pe(Te,n);return Ce(s,ce)},be=e=>{const[t,{children:o,...r}]=Y(e),n=Ie(r),s=X(h({present:n.open},t));return p.jsx(fe,{value:n,children:p.jsx(J,{value:s,children:o})})},G=a.forwardRef((e,t)=>{const o=y(),r=w(),n=h({...o.getTriggerProps(),"aria-controls":r.unmounted?void 0:o.getTriggerProps()["aria-controls"]},e);return p.jsx(E.button,{...n,ref:t})});G.displayName="PopoverTrigger";const V=a.createContext(void 0);function W({children:e,onPositionChange:t}){const[o,r]=a.useState(),[n,s]=a.useState();return p.jsx(V.Provider,{value:{contentId:o,onPositionChange:t,setContentId:r,setTriggerId:s,triggerId:n},children:e})}function x(){const e=a.useContext(V);if(!e)throw new Error("usePopover must be used within a PopoverProvider");return e}W.__docgenInfo={description:"",methods:[],displayName:"PopoverProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}},composes:["Pick"]};const we=({autoFocus:e=!0,children:t,gutter:o,onOpenChange:r,open:n,position:s=H.top,sameWidth:i,triggerId:c,...l})=>{const{contentId:m,triggerId:u}=x();return p.jsx(be,{autoFocus:e,ids:{content:m,trigger:c??u},onOpenChange:r,open:n,positioning:{gutter:o,placement:s,sameWidth:i},...l,children:t})},M=({onPositionChange:e,...t})=>p.jsx(W,{onPositionChange:e,children:p.jsx(we,{...t})});M.displayName="Popover";M.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{autoFocus:{required:!1,tsType:{name:"boolean"},description:"Whether to automatically set focus on the first focusable content within the popover when opened."},gutter:{required:!1,tsType:{name:"number"},description:"The main axis offset or gap between the reference and floating elements"},onOpenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(detail: PopoverOpenChangeDetail) => void",signature:{arguments:[{type:{name:"PopoverOpenChangeDetail"},name:"detail"}],return:{name:"void"}}},description:"Callback fired when the popover open state changes."},onPositionChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(detail: PopoverPositionChangeDetail) => void",signature:{arguments:[{type:{name:"PopoverPositionChangeDetail"},name:"detail"}],return:{name:"void"}}},description:"Callback fired when the popover position changes."},open:{required:!1,tsType:{name:"boolean"},description:"The controlled open state of the popover."},position:{required:!1,tsType:{name:"literal",value:"`${OVERLAY_POSITION}`"},description:`@type=POPOVER_POSITION
The popover position around the trigger.`},sameWidth:{required:!1,tsType:{name:"boolean"},description:"Whether to make the floating element same width as the reference element."},triggerId:{required:!1,tsType:{name:"string"},description:"ID of an external trigger element to use in place of the PopoverTrigger component."}}};const xe={"popover-content":"_popover-content_6kx3n_2"},K=a.forwardRef(({children:e,className:t,createPortal:o=!0,id:r,withArrow:n=!1,...s},i)=>{const c=a.useId(),{onPositionChange:l,setContentId:m}=x(),u=a.useRef(null),O=a.useMemo(()=>r??c,[c,r]);return a.useImperativeHandle(i,()=>u.current,[u]),a.useEffect(()=>{m(O)},[O,m]),a.useEffect(()=>{if(u.current){const v=new MutationObserver(d=>{if(d.length){const F=d[0].target.dataset;l==null||l({position:F.placement})}});return v.observe(u.current,{attributeFilter:["data-placement"],attributes:!0}),()=>{v.disconnect()}}},[u,l]),p.jsx(Q,{disabled:!o,children:p.jsx(A,{children:p.jsxs(_,{className:S(xe["popover-content"],t),"data-ods":"popover-content",ref:u,...s,children:[n&&p.jsx(L,{children:p.jsx(j,{})}),e]})})})});K.displayName="PopoverContent";K.__docgenInfo={description:"",methods:[],displayName:"PopoverContent",props:{createPortal:{required:!1,tsType:{name:"boolean"},description:"Whether the component should be rendered in the DOM close to the body tag.",defaultValue:{value:"true",computed:!1}},withArrow:{required:!1,tsType:{name:"boolean"},description:"Whether the component displays an arrow pointing to the trigger.",defaultValue:{value:"false",computed:!1}}},composes:["ComponentPropsWithRef"]};const Fe={"popover-trigger":"_popover-trigger_a014q_2"},U=a.forwardRef(({asChild:e,children:t,className:o,...r},n)=>{const{setTriggerId:s}=x();return a.useEffect(()=>{var i;if(!e&&r.id){s==null||s(r.id);return}t&&((i=t.props)!=null&&i.id)&&(s==null||s(t.props.id))},[e,t,r,s]),p.jsx(G,{asChild:e,className:S(Fe["popover-trigger"],o),"data-ods":"popover-trigger",ref:n,role:"button",tabIndex:0,...r,children:t})});U.displayName="PopoverTrigger";U.__docgenInfo={description:"",methods:[],displayName:"PopoverTrigger",props:{asChild:{required:!1,tsType:{name:"boolean"},description:`Use the provided child element as the default rendered element, combining their props and behavior.
Be careful to pass an actual Node, not a Fragment.`}},composes:["ComponentPropsWithRef"]};export{U as P,K as a,M as b};
