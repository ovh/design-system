import{j as c}from"./jsx-runtime-Cfl8ynUo.js";import{r as p}from"./index-jIWwRBLr.js";import{c as T,T as u,U as E,V as R,Q as h,C as F,z as L,r as y,B as S,u as N,R as B,D as x,S as w}from"./use-locale-context-6s5qsrWI.js";import{u as P,a as j,P as $}from"./use-presence-Dwt5F0sJ.js";import{s as G,R as V}from"./render-strategy-BOAyFnMW.js";import{s as q}from"./portal--PO1aV1j.js";import{a as K,t as M,p as Z}from"./index-CKV47Z30.js";import{t as A}from"./index-DEFWe41X.js";const[H,f]=T({name:"DialogContext",hookName:"useDialogContext",providerName:"<DialogProvider />"}),Q=p.forwardRef((e,t)=>{const o=f(),n=P(),r=u(o.getContentProps(),n.getPresenceProps(),e);return n.unmounted?null:c.jsx(E.div,{...r,ref:R(n.ref,t)})});Q.displayName="DialogContent";const U=p.forwardRef((e,t)=>{const o=f(),n=u(o.getPositionerProps(),e);return P().unmounted?null:c.jsx(E.div,{...n,ref:t})});U.displayName="DialogPositioner";var J=h("dialog").parts("trigger","backdrop","positioner","content","title","description","closeTrigger"),d=J.build(),D=e=>{var t;return((t=e.ids)==null?void 0:t.positioner)??`dialog:${e.id}:positioner`},k=e=>{var t;return((t=e.ids)==null?void 0:t.backdrop)??`dialog:${e.id}:backdrop`},m=e=>{var t;return((t=e.ids)==null?void 0:t.content)??`dialog:${e.id}:content`},b=e=>{var t;return((t=e.ids)==null?void 0:t.trigger)??`dialog:${e.id}:trigger`},O=e=>{var t;return((t=e.ids)==null?void 0:t.title)??`dialog:${e.id}:title`},v=e=>{var t;return((t=e.ids)==null?void 0:t.description)??`dialog:${e.id}:description`},I=e=>{var t;return((t=e.ids)==null?void 0:t.closeTrigger)??`dialog:${e.id}:close`},g=e=>e.getById(m(e)),W=e=>e.getById(D(e)),X=e=>e.getById(k(e)),Y=e=>e.getById(b(e)),_=e=>e.getById(O(e)),z=e=>e.getById(v(e)),ee=e=>e.getById(I(e));function te(e,t){const{state:o,send:n,context:r,prop:s,scope:i}=e,C=s("aria-label"),l=o.matches("open");return{open:l,setOpen(a){o.matches("open")!==a&&n({type:a?"OPEN":"CLOSE"})},getTriggerProps(){return t.button({...d.trigger.attrs,dir:s("dir"),id:b(i),"aria-haspopup":"dialog",type:"button","aria-expanded":l,"data-state":l?"open":"closed","aria-controls":m(i),onClick(a){a.defaultPrevented||n({type:"TOGGLE"})}})},getBackdropProps(){return t.element({...d.backdrop.attrs,dir:s("dir"),hidden:!l,id:k(i),"data-state":l?"open":"closed"})},getPositionerProps(){return t.element({...d.positioner.attrs,dir:s("dir"),id:D(i),style:{pointerEvents:l?void 0:"none"}})},getContentProps(){const a=r.get("rendered");return t.element({...d.content.attrs,dir:s("dir"),role:s("role"),hidden:!l,id:m(i),tabIndex:-1,"data-state":l?"open":"closed","aria-modal":!0,"aria-label":C||void 0,"aria-labelledby":C||!a.title?void 0:O(i),"aria-describedby":a.description?v(i):void 0})},getTitleProps(){return t.element({...d.title.attrs,dir:s("dir"),id:O(i)})},getDescriptionProps(){return t.element({...d.description.attrs,dir:s("dir"),id:v(i)})},getCloseTriggerProps(){return t.button({...d.closeTrigger.attrs,dir:s("dir"),id:I(i),type:"button",onClick(a){a.defaultPrevented||(a.stopPropagation(),n({type:"CLOSE"}))}})}}}var oe=L({props({props:e,scope:t}){const o=e.role==="alertdialog",n=o?()=>ee(t):void 0,r=typeof e.modal=="boolean"?e.modal:!0;return{role:"dialog",modal:r,trapFocus:r,preventScroll:r,closeOnInteractOutside:!o,closeOnEscape:!0,restoreFocus:!0,initialFocusEl:n,...e}},initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{rendered:e(()=>({defaultValue:{title:!0,description:!0}}))}},watch({track:e,action:t,prop:o}){e([()=>o("open")],()=>{t(["toggleVisibility"])})},states:{open:{entry:["checkRenderedElements","syncZIndex"],effects:["trackDismissableElement","trapFocus","preventScroll","hideContentBelow"],on:{"CONTROLLED.CLOSE":{target:"closed"},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}]}},closed:{on:{"CONTROLLED.OPEN":{target:"open"},OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen"]}]}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackDismissableElement({scope:e,send:t,prop:o}){return A(()=>g(e),{type:"dialog",defer:!0,pointerBlocking:o("modal"),exclude:[Y(e)],onInteractOutside(r){var s;(s=o("onInteractOutside"))==null||s(r),o("closeOnInteractOutside")||r.preventDefault()},persistentElements:o("persistentElements"),onFocusOutside:o("onFocusOutside"),onPointerDownOutside:o("onPointerDownOutside"),onRequestDismiss:o("onRequestDismiss"),onEscapeKeyDown(r){var s;(s=o("onEscapeKeyDown"))==null||s(r),o("closeOnEscape")||r.preventDefault()},onDismiss(){t({type:"CLOSE",src:"interact-outside"})}})},preventScroll({scope:e,prop:t}){if(t("preventScroll"))return Z(e.getDoc())},trapFocus({scope:e,prop:t}){return t("trapFocus")?M(()=>g(e),{preventScroll:!0,returnFocusOnDeactivate:!!t("restoreFocus"),initialFocus:t("initialFocusEl"),setReturnFocus:n=>{var r;return((r=t("finalFocusEl"))==null?void 0:r())??n}}):void 0},hideContentBelow({scope:e,prop:t}){return t("modal")?K(()=>[g(e)],{defer:!0}):void 0}},actions:{checkRenderedElements({context:e,scope:t}){y(()=>{e.set("rendered",{title:!!_(t),description:!!z(t)})})},syncZIndex({scope:e}){y(()=>{const t=g(e);if(!t)return;const o=S(t);[W(e),X(e)].forEach(r=>{r==null||r.style.setProperty("--z-index",o.zIndex),r==null||r.style.setProperty("--layer-index",o.getPropertyValue("--layer-index"))})})},invokeOnClose({prop:e}){var t;(t=e("onOpenChange"))==null||t({open:!1})},invokeOnOpen({prop:e}){var t;(t=e("onOpenChange"))==null||t({open:!0})},toggleVisibility({prop:e,send:t,event:o}){t({type:e("open")?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:o})}}}});F()(["aria-label","closeOnEscape","closeOnInteractOutside","dir","finalFocusEl","getRootNode","getRootNode","id","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","onRequestDismiss","defaultOpen","open","persistentElements","preventScroll","restoreFocus","role","trapFocus"]);const re=e=>{const t=p.useId(),{getRootNode:o}=N(),{dir:n}=B(),r={id:t,getRootNode:o,dir:n,...e},s=x(oe,r);return te(s,w)},me=e=>{const[t,{children:o,...n}]=q(e),[r]=G(t),s=re(n),i=j(u({present:s.open},t));return c.jsx(H,{value:s,children:c.jsx(V,{value:r,children:c.jsx($,{value:i,children:o})})})},ne=p.forwardRef((e,t)=>{const o=f(),n=P(),r=u({...o.getTriggerProps(),"aria-controls":n.unmounted?void 0:o.getTriggerProps()["aria-controls"]},e);return c.jsx(E.button,{...r,ref:t})});ne.displayName="DialogTrigger";export{me as D,U as a,Q as b,ne as c,f as u};
