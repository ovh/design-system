import{g as d,b as E,i as g,d as L,e as F}from"./use-locale-context-Da8UBLVe.js";function T(e){return!(e.metaKey||!F()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}var M=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function H(e,r,n){const t=n?L(n):null,i=d(t);return e=e||t instanceof i.HTMLInputElement&&!M.has(t==null?void 0:t.type)||t instanceof i.HTMLTextAreaElement||t instanceof i.HTMLElement&&t.isContentEditable,!(e&&r==="keyboard"&&n instanceof i.KeyboardEvent&&!Reflect.has(K,n.key))}var s=null,v=new Set,a=new Map,u=!1,f=!1,K={Tab:!0,Escape:!0};function c(e,r){for(let n of v)n(e,r)}function l(e){u=!0,T(e)&&(s="keyboard",c("keyboard",e))}function o(e){s="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(u=!0,c("pointer",e))}function b(e){g(e)&&(u=!0,s="virtual")}function w(e){const r=L(e);r===d(r)||r===E(r)||(!u&&!f&&(s="virtual",c("virtual",e)),u=!1,f=!1)}function k(){u=!1,f=!0}function V(e){if(typeof window>"u"||a.get(d(e)))return;const r=d(e),n=E(e);let t=r.HTMLElement.prototype.focus;function i(){s="virtual",c("virtual",null),u=!0,t.apply(this,arguments)}Object.defineProperty(r.HTMLElement.prototype,"focus",{configurable:!0,value:i}),n.addEventListener("keydown",l,!0),n.addEventListener("keyup",l,!0),n.addEventListener("click",b,!0),r.addEventListener("focus",w,!0),r.addEventListener("blur",k,!1),typeof r.PointerEvent<"u"?(n.addEventListener("pointerdown",o,!0),n.addEventListener("pointermove",o,!0),n.addEventListener("pointerup",o,!0)):(n.addEventListener("mousedown",o,!0),n.addEventListener("mousemove",o,!0),n.addEventListener("mouseup",o,!0)),r.addEventListener("beforeunload",()=>{S(e)},{once:!0}),a.set(r,{focus:t})}var S=(e,r)=>{const n=d(e),t=E(e);a.has(n)&&(n.HTMLElement.prototype.focus=a.get(n).focus,t.removeEventListener("keydown",l,!0),t.removeEventListener("keyup",l,!0),t.removeEventListener("click",b,!0),n.removeEventListener("focus",w,!0),n.removeEventListener("blur",k,!1),typeof n.PointerEvent<"u"?(t.removeEventListener("pointerdown",o,!0),t.removeEventListener("pointermove",o,!0),t.removeEventListener("pointerup",o,!0)):(t.removeEventListener("mousedown",o,!0),t.removeEventListener("mousemove",o,!0),t.removeEventListener("mouseup",o,!0)),a.delete(n))};function y(){return s==="keyboard"}function B(e={}){const{isTextInput:r,autoFocus:n,onChange:t,root:i}=e;V(i),t==null||t({isFocusVisible:n||y(),modality:s});const p=(m,h)=>{H(!!r,m,h)&&(t==null||t({isFocusVisible:y(),modality:m}))};return v.add(p),()=>{v.delete(p)}}export{y as i,B as t};
