import{j as p}from"./jsx-runtime-Cfl8ynUo.js";import{a as Y}from"./overlay-CZHjGBMC.js";import{s as Q,P as J}from"./portal-Dz6APLpY.js";import{u as x,a as X,P as Z}from"./use-presence-BpdcDhnz.js";import{c as z,P as O,Q as E,a4 as ee,z as te,r as I,ab as oe,S as re,R as ne,a7 as se,U as ie,ac as N,C as ae,u as de,a2 as pe,D as ce,a3 as le}from"./use-locale-context-Da8UBLVe.js";import{a as R,g as ue}from"./index-BY2p2mzr.js";import{t as ge,p as me,a as ve}from"./index-n4SY88MZ.js";import{t as fe}from"./index-B-pxw7wW.js";import{r as a}from"./index-jIWwRBLr.js";import{c as S}from"./index-CqY9YpN0.js";import{u as Pe}from"./context-C_-r2uoG.js";const[Oe,h]=z({name:"PopoverContext",hookName:"usePopoverContext",providerName:"<PopoverProvider />"}),L=a.forwardRef((e,t)=>{const o=h(),r=O(o.getArrowProps(),e);return p.jsx(E.div,{...r,ref:t})});L.displayName="PopoverArrow";const j=a.forwardRef((e,t)=>{const o=h(),r=O(o.getArrowTipProps(),e);return p.jsx(E.div,{...r,ref:t})});j.displayName="PopoverArrowTip";const _=a.forwardRef((e,t)=>{const o=h(),r=x(),n=O(o.getContentProps(),r.getPresenceProps(),e);return r.unmounted?null:p.jsx(E.div,{...n,ref:ee(r.ref,t)})});_.displayName="PopoverContent";const A=a.forwardRef((e,t)=>{const o=h(),r=x(),n=O(o.getPositionerProps(),e);return r.unmounted?null:p.jsx(E.div,{...n,ref:t})});A.displayName="PopoverPositioner";var he=re("popover").parts("arrow","arrowTip","anchor","trigger","indicator","positioner","content","title","description","closeTrigger"),u=he.build(),q=e=>{var t;return((t=e.ids)==null?void 0:t.anchor)??`popover:${e.id}:anchor`},$=e=>{var t;return((t=e.ids)==null?void 0:t.trigger)??`popover:${e.id}:trigger`},T=e=>{var t;return((t=e.ids)==null?void 0:t.content)??`popover:${e.id}:content`},B=e=>{var t;return((t=e.ids)==null?void 0:t.positioner)??`popover:${e.id}:popper`},ye=e=>{var t;return((t=e.ids)==null?void 0:t.arrow)??`popover:${e.id}:arrow`},b=e=>{var t;return((t=e.ids)==null?void 0:t.title)??`popover:${e.id}:title`},w=e=>{var t;return((t=e.ids)==null?void 0:t.description)??`popover:${e.id}:desc`},Ee=e=>{var t;return((t=e.ids)==null?void 0:t.closeTrigger)??`popover:${e.id}:close`},D=e=>e.getById(q(e)),f=e=>e.getById($(e)),P=e=>e.getById(T(e)),k=e=>e.getById(B(e)),Ce=e=>e.getById(b(e)),Ie=e=>e.getById(w(e));function Te(e,t){const{state:o,context:r,send:n,computed:s,prop:i,scope:c}=e,l=o.matches("open"),m=r.get("currentPlacement"),y=s("currentPortalled"),g=r.get("renderedElements"),v=ue({...i("positioning"),placement:m});return{portalled:y,open:l,setOpen(d){o.matches("open")!==d&&n({type:d?"OPEN":"CLOSE"})},reposition(d={}){n({type:"POSITIONING.SET",options:d})},getArrowProps(){return t.element({id:ye(c),...u.arrow.attrs,dir:i("dir"),style:v.arrow})},getArrowTipProps(){return t.element({...u.arrowTip.attrs,dir:i("dir"),style:v.arrowTip})},getAnchorProps(){return t.element({...u.anchor.attrs,dir:i("dir"),id:q(c)})},getTriggerProps(){return t.button({...u.trigger.attrs,dir:i("dir"),type:"button","data-placement":m,id:$(c),"aria-haspopup":"dialog","aria-expanded":l,"data-state":l?"open":"closed","aria-controls":T(c),onPointerDown(d){se(d)&&ie()&&d.currentTarget.focus()},onClick(d){d.defaultPrevented||n({type:"TOGGLE"})},onBlur(d){n({type:"TRIGGER_BLUR",target:d.relatedTarget})}})},getIndicatorProps(){return t.element({...u.indicator.attrs,dir:i("dir"),"data-state":l?"open":"closed"})},getPositionerProps(){return t.element({id:B(c),...u.positioner.attrs,dir:i("dir"),style:v.floating})},getContentProps(){return t.element({...u.content.attrs,dir:i("dir"),id:T(c),tabIndex:-1,role:"dialog",hidden:!l,"data-state":l?"open":"closed","data-expanded":ne(l),"aria-labelledby":g.title?b(c):void 0,"aria-describedby":g.description?w(c):void 0,"data-placement":m})},getTitleProps(){return t.element({...u.title.attrs,id:b(c),dir:i("dir")})},getDescriptionProps(){return t.element({...u.description.attrs,id:w(c),dir:i("dir")})},getCloseTriggerProps(){return t.button({...u.closeTrigger.attrs,dir:i("dir"),id:Ee(c),type:"button","aria-label":"close",onClick(d){d.defaultPrevented||(d.stopPropagation(),n({type:"CLOSE"}))}})}}}var be=te({props({props:e}){return{closeOnInteractOutside:!0,closeOnEscape:!0,autoFocus:!0,modal:!1,portalled:!0,...e,positioning:{placement:"bottom",...e.positioning}}},initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{currentPlacement:e(()=>({defaultValue:void 0})),renderedElements:e(()=>({defaultValue:{title:!0,description:!0}}))}},computed:{currentPortalled:({prop:e})=>!!e("modal")||!!e("portalled")},watch({track:e,prop:t,action:o}){e([()=>t("open")],()=>{o(["toggleVisibility"])})},entry:["checkRenderedElements"],states:{closed:{on:{"CONTROLLED.OPEN":{target:"open",actions:["setInitialFocus"]},TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}],OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}]}},open:{effects:["trapFocus","preventScroll","hideContentBelow","trackPositioning","trackDismissableElement","proxyTabFocus"],on:{"CONTROLLED.CLOSE":{target:"closed",actions:["setFinalFocus"]},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],"POSITIONING.SET":{actions:["reposition"]}}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackPositioning({context:e,prop:t,scope:o}){e.set("currentPlacement",t("positioning").placement);const r=D(o)??f(o);return R(r,()=>k(o),{...t("positioning"),defer:!0,onComplete(s){e.set("currentPlacement",s.placement)}})},trackDismissableElement({send:e,prop:t,scope:o}){const r=()=>P(o);let n=!0;return fe(r,{type:"popover",pointerBlocking:t("modal"),exclude:f(o),defer:!0,onEscapeKeyDown(s){var i;(i=t("onEscapeKeyDown"))==null||i(s),!t("closeOnEscape")&&s.preventDefault()},onInteractOutside(s){var i;(i=t("onInteractOutside"))==null||i(s),!s.defaultPrevented&&(n=!(s.detail.focusable||s.detail.contextmenu),t("closeOnInteractOutside")||s.preventDefault())},onPointerDownOutside:t("onPointerDownOutside"),onFocusOutside:t("onFocusOutside"),persistentElements:t("persistentElements"),onRequestDismiss:t("onRequestDismiss"),onDismiss(){e({type:"CLOSE",src:"interact-outside",restoreFocus:n})}})},proxyTabFocus({prop:e,scope:t}){return e("modal")||!e("portalled")?void 0:oe(()=>P(t),{triggerElement:f(t),defer:!0,onFocus(r){r.focus({preventScroll:!0})}})},hideContentBelow({prop:e,scope:t}){return e("modal")?ve(()=>[P(t),f(t)],{defer:!0}):void 0},preventScroll({prop:e,scope:t}){if(e("modal"))return me(t.getDoc())},trapFocus({prop:e,scope:t}){return e("modal")?ge(()=>P(t),{initialFocus:()=>N({root:P(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")})}):void 0}},actions:{reposition({event:e,prop:t,scope:o,context:r}){const n=D(o)??f(o);R(n,()=>k(o),{...t("positioning"),...e.options,defer:!0,listeners:!1,onComplete(i){r.set("currentPlacement",i.placement)}})},checkRenderedElements({context:e,scope:t}){I(()=>{Object.assign(e.get("renderedElements"),{title:!!Ce(t),description:!!Ie(t)})})},setInitialFocus({prop:e,scope:t}){e("modal")||I(()=>{const o=N({root:P(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")});o==null||o.focus({preventScroll:!0})})},setFinalFocus({event:e,scope:t}){var r;const o=e.restoreFocus??((r=e.previousEvent)==null?void 0:r.restoreFocus);o!=null&&!o||I(()=>{const n=f(t);n==null||n.focus({preventScroll:!0})})},invokeOnOpen({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!0})})},invokeOnClose({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!1})})},toggleVisibility({event:e,send:t,prop:o}){t({type:o("open")?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:e})}}}});ae()(["autoFocus","closeOnEscape","closeOnInteractOutside","dir","getRootNode","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","onRequestDismiss","defaultOpen","open","persistentElements","portalled","positioning"]);const we=e=>{const t=a.useId(),{getRootNode:o}=de(),{dir:r}=pe(),n={id:t,dir:r,getRootNode:o,...e},s=ce(be,n);return Te(s,le)},xe=e=>{const[t,{children:o,...r}]=Q(e),n=we(r),s=X(O({present:n.open},t));return p.jsx(Oe,{value:n,children:p.jsx(Z,{value:s,children:o})})},G=a.forwardRef((e,t)=>{const o=h(),r=x(),n=O({...o.getTriggerProps(),"aria-controls":r.unmounted?void 0:o.getTriggerProps()["aria-controls"]},e);return p.jsx(E.button,{...n,ref:t})});G.displayName="PopoverTrigger";const V=a.createContext(void 0);function W({children:e,onPositionChange:t}){const[o,r]=a.useState(),[n,s]=a.useState();return p.jsx(V.Provider,{value:{contentId:o,onPositionChange:t,setContentId:r,setTriggerId:s,triggerId:n},children:e})}function F(){return Pe(V)}W.__docgenInfo={description:"",methods:[],displayName:"PopoverProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}},composes:["Pick"]};const Fe=({autoFocus:e=!0,children:t,gutter:o,onOpenChange:r,open:n,position:s=Y.top,sameWidth:i,triggerId:c,...l})=>{const{contentId:m,triggerId:y}=F();return p.jsx(xe,{autoFocus:e,ids:{content:m,trigger:c??y},onOpenChange:r,open:n,positioning:{gutter:o,placement:s,sameWidth:i},...l,children:t})},M=({onPositionChange:e,...t})=>p.jsx(W,{onPositionChange:e,children:p.jsx(Fe,{...t})});M.displayName="Popover";M.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{autoFocus:{required:!1,tsType:{name:"boolean"},description:"Whether to automatically set focus on the first focusable content within the popover when opened."},gutter:{required:!1,tsType:{name:"number"},description:"The main axis offset or gap between the reference and floating elements"},onOpenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(detail: PopoverOpenChangeDetail) => void",signature:{arguments:[{type:{name:"PopoverOpenChangeDetail"},name:"detail"}],return:{name:"void"}}},description:"Callback fired when the popover open state changes."},onPositionChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(detail: PopoverPositionChangeDetail) => void",signature:{arguments:[{type:{name:"PopoverPositionChangeDetail"},name:"detail"}],return:{name:"void"}}},description:"Callback fired when the popover position changes."},open:{required:!1,tsType:{name:"boolean"},description:"The controlled open state of the popover."},position:{required:!1,tsType:{name:"literal",value:"`${OVERLAY_POSITION}`"},description:`@type=POPOVER_POSITION
The popover position around the trigger.`},sameWidth:{required:!1,tsType:{name:"boolean"},description:"Whether to make the floating element same width as the reference element."},triggerId:{required:!1,tsType:{name:"string"},description:"ID of an external trigger element to use in place of the PopoverTrigger component."}}};const Ne={"popover-content":"_popover-content_3od5l_2"},K=a.forwardRef(({children:e,className:t,createPortal:o=!0,id:r,withArrow:n=!1,...s},i)=>{const c=a.useId(),{onPositionChange:l,setContentId:m}=F(),{open:y}=h(),g=a.useRef(null),v=a.useMemo(()=>r??c,[c,r]);return a.useImperativeHandle(i,()=>g.current,[g]),a.useEffect(()=>{m(v)},[v,m]),a.useEffect(()=>{if(g.current){const d=new MutationObserver(C=>{if(C.length){const H=C[0].target.dataset;l==null||l({position:H.placement})}});return d.observe(g.current,{attributeFilter:["data-placement"],attributes:!0}),()=>{d.disconnect()}}},[g,l]),p.jsx(J,{disabled:!o,children:p.jsx(A,{style:{zIndex:"var(--ods-theme-overlay-z-index)"},children:p.jsxs(_,{className:S(Ne["popover-content"],t),"data-ods":"popover-content",ref:g,...s,style:{...s.style,...y?{}:{display:"none"}},children:[n&&p.jsx(L,{children:p.jsx(j,{})}),e]})})})});K.displayName="PopoverContent";K.__docgenInfo={description:"",methods:[],displayName:"PopoverContent",props:{createPortal:{required:!1,tsType:{name:"boolean"},description:"Whether the component should be rendered in the DOM close to the body tag.",defaultValue:{value:"true",computed:!1}},withArrow:{required:!1,tsType:{name:"boolean"},description:"Whether the component displays an arrow pointing to the trigger.",defaultValue:{value:"false",computed:!1}}},composes:["ComponentPropsWithRef"]};const Re={"popover-trigger":"_popover-trigger_zwyzw_2"},U=a.forwardRef(({asChild:e,children:t,className:o,...r},n)=>{const{setTriggerId:s}=F();return a.useEffect(()=>{var i;if(!e&&r.id){s==null||s(r.id);return}t&&((i=t.props)!=null&&i.id)&&(s==null||s(t.props.id))},[e,t,r,s]),p.jsx(G,{asChild:e,className:S(Re["popover-trigger"],o),"data-ods":"popover-trigger",ref:n,role:"button",tabIndex:0,...r,children:t})});U.displayName="PopoverTrigger";U.__docgenInfo={description:"",methods:[],displayName:"PopoverTrigger",props:{asChild:{required:!1,tsType:{name:"boolean"},description:`Use the provided child element as the default rendered element, combining their props and behavior.
Be careful to pass an actual Node, not a Fragment.`}},composes:["ComponentPropsWithRef"]};export{U as P,K as a,M as b};
