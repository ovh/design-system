import{j as p}from"./jsx-runtime-Cfl8ynUo.js";import{a as Q}from"./overlay-CZHjGBMC.js";import{a as R,g as J,s as X,P as Z}from"./portal-CJHwXgLI.js";import{u as x,a as z,P as ee}from"./use-presence-C53EI5fL.js";import{c as te,L as h,M as y,a4 as oe,y as re,r as T,ab as ne,O as se,N as ie,a7 as ae,Q as de,ac as D,B as pe,_ as le,$ as ce,C as ue,a0 as ge}from"./use-locale-context-kHyebpMI.js";import{t as me,p as ve,a as fe}from"./index-BwUtbHV0.js";import{t as Pe}from"./index-BFzjWlov.js";import{r as a}from"./index-jIWwRBLr.js";import{c as L}from"./index-CqY9YpN0.js";import{u as he}from"./context-C_-r2uoG.js";const[Oe,O]=te({name:"PopoverContext",hookName:"usePopoverContext",providerName:"<PopoverProvider />"}),j=a.forwardRef((e,t)=>{const o=O(),r=h(o.getArrowProps(),e);return p.jsx(y.div,{...r,ref:t})});j.displayName="PopoverArrow";const _=a.forwardRef((e,t)=>{const o=O(),r=h(o.getArrowTipProps(),e);return p.jsx(y.div,{...r,ref:t})});_.displayName="PopoverArrowTip";const A=a.forwardRef((e,t)=>{const o=O(),r=x(),n=h(o.getContentProps(),r.getPresenceProps(),e);return r.unmounted?null:p.jsx(y.div,{...n,ref:oe(r.ref,t)})});A.displayName="PopoverContent";const q=a.forwardRef((e,t)=>{const o=O(),r=x(),n=h(o.getPositionerProps(),e);return r.unmounted?null:p.jsx(y.div,{...n,ref:t})});q.displayName="PopoverPositioner";var ye=se("popover").parts("arrow","arrowTip","anchor","trigger","indicator","positioner","content","title","description","closeTrigger"),g=ye.build(),$=e=>{var t;return((t=e.ids)==null?void 0:t.anchor)??`popover:${e.id}:anchor`},B=e=>{var t;return((t=e.ids)==null?void 0:t.trigger)??`popover:${e.id}:trigger`},I=e=>{var t;return((t=e.ids)==null?void 0:t.content)??`popover:${e.id}:content`},G=e=>{var t;return((t=e.ids)==null?void 0:t.positioner)??`popover:${e.id}:popper`},Ee=e=>{var t;return((t=e.ids)==null?void 0:t.arrow)??`popover:${e.id}:arrow`},w=e=>{var t;return((t=e.ids)==null?void 0:t.title)??`popover:${e.id}:title`},b=e=>{var t;return((t=e.ids)==null?void 0:t.description)??`popover:${e.id}:desc`},Ce=e=>{var t;return((t=e.ids)==null?void 0:t.closeTrigger)??`popover:${e.id}:close`},S=e=>e.getById($(e)),f=e=>e.getById(B(e)),P=e=>e.getById(I(e)),k=e=>e.getById(G(e)),Te=e=>e.getById(w(e)),Ie=e=>e.getById(b(e));function we(e,t){const{state:o,context:r,send:n,computed:s,prop:i,scope:l}=e,c=o.matches("open"),m=r.get("currentPlacement"),v=s("currentPortalled"),E=r.get("renderedElements"),u=J({...i("positioning"),placement:m});return{portalled:v,open:c,setOpen(d){o.matches("open")!==d&&n({type:d?"OPEN":"CLOSE"})},reposition(d={}){n({type:"POSITIONING.SET",options:d})},getArrowProps(){return t.element({id:Ee(l),...g.arrow.attrs,dir:i("dir"),style:u.arrow})},getArrowTipProps(){return t.element({...g.arrowTip.attrs,dir:i("dir"),style:u.arrowTip})},getAnchorProps(){return t.element({...g.anchor.attrs,dir:i("dir"),id:$(l)})},getTriggerProps(){return t.button({...g.trigger.attrs,dir:i("dir"),type:"button","data-placement":m,id:B(l),"aria-haspopup":"dialog","aria-expanded":c,"data-state":c?"open":"closed","aria-controls":I(l),onPointerDown(d){ae(d)&&de()&&d.currentTarget.focus()},onClick(d){d.defaultPrevented||n({type:"TOGGLE"})},onBlur(d){n({type:"TRIGGER_BLUR",target:d.relatedTarget})}})},getIndicatorProps(){return t.element({...g.indicator.attrs,dir:i("dir"),"data-state":c?"open":"closed"})},getPositionerProps(){return t.element({id:G(l),...g.positioner.attrs,dir:i("dir"),style:u.floating})},getContentProps(){return t.element({...g.content.attrs,dir:i("dir"),id:I(l),tabIndex:-1,role:"dialog",hidden:!c,"data-state":c?"open":"closed","data-expanded":ie(c),"aria-labelledby":E.title?w(l):void 0,"aria-describedby":E.description?b(l):void 0,"data-placement":m})},getTitleProps(){return t.element({...g.title.attrs,id:w(l),dir:i("dir")})},getDescriptionProps(){return t.element({...g.description.attrs,id:b(l),dir:i("dir")})},getCloseTriggerProps(){return t.button({...g.closeTrigger.attrs,dir:i("dir"),id:Ce(l),type:"button","aria-label":"close",onClick(d){d.defaultPrevented||(d.stopPropagation(),n({type:"CLOSE"}))}})}}}var be=re({props({props:e}){return{closeOnInteractOutside:!0,closeOnEscape:!0,autoFocus:!0,modal:!1,portalled:!0,...e,positioning:{placement:"bottom",...e.positioning}}},initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{currentPlacement:e(()=>({defaultValue:void 0})),renderedElements:e(()=>({defaultValue:{title:!0,description:!0}}))}},computed:{currentPortalled:({prop:e})=>!!e("modal")||!!e("portalled")},watch({track:e,prop:t,action:o}){e([()=>t("open")],()=>{o(["toggleVisibility"])})},entry:["checkRenderedElements"],states:{closed:{on:{"CONTROLLED.OPEN":{target:"open",actions:["setInitialFocus"]},TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}],OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}]}},open:{effects:["trapFocus","preventScroll","hideContentBelow","trackPositioning","trackDismissableElement","proxyTabFocus"],on:{"CONTROLLED.CLOSE":{target:"closed",actions:["setFinalFocus"]},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],"POSITIONING.SET":{actions:["reposition"]}}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackPositioning({context:e,prop:t,scope:o}){e.set("currentPlacement",t("positioning").placement);const r=S(o)??f(o);return R(r,()=>k(o),{...t("positioning"),defer:!0,onComplete(s){e.set("currentPlacement",s.placement)}})},trackDismissableElement({send:e,prop:t,scope:o}){const r=()=>P(o);let n=!0;return Pe(r,{type:"popover",pointerBlocking:t("modal"),exclude:f(o),defer:!0,onEscapeKeyDown(s){var i;(i=t("onEscapeKeyDown"))==null||i(s),!t("closeOnEscape")&&s.preventDefault()},onInteractOutside(s){var i;(i=t("onInteractOutside"))==null||i(s),!s.defaultPrevented&&(n=!(s.detail.focusable||s.detail.contextmenu),t("closeOnInteractOutside")||s.preventDefault())},onPointerDownOutside:t("onPointerDownOutside"),onFocusOutside:t("onFocusOutside"),persistentElements:t("persistentElements"),onRequestDismiss:t("onRequestDismiss"),onDismiss(){e({type:"CLOSE",src:"interact-outside",restoreFocus:n})}})},proxyTabFocus({prop:e,scope:t}){return e("modal")||!e("portalled")?void 0:ne(()=>P(t),{triggerElement:f(t),defer:!0,onFocus(r){r.focus({preventScroll:!0})}})},hideContentBelow({prop:e,scope:t}){return e("modal")?fe(()=>[P(t),f(t)],{defer:!0}):void 0},preventScroll({prop:e,scope:t}){if(e("modal"))return ve(t.getDoc())},trapFocus({prop:e,scope:t}){return e("modal")?me(()=>P(t),{initialFocus:()=>D({root:P(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")})}):void 0}},actions:{reposition({event:e,prop:t,scope:o,context:r}){const n=S(o)??f(o);R(n,()=>k(o),{...t("positioning"),...e.options,defer:!0,listeners:!1,onComplete(i){r.set("currentPlacement",i.placement)}})},checkRenderedElements({context:e,scope:t}){T(()=>{Object.assign(e.get("renderedElements"),{title:!!Te(t),description:!!Ie(t)})})},setInitialFocus({prop:e,scope:t}){e("modal")||T(()=>{const o=D({root:P(t),getInitialEl:e("initialFocusEl"),enabled:e("autoFocus")});o==null||o.focus({preventScroll:!0})})},setFinalFocus({event:e,scope:t}){var r;const o=e.restoreFocus??((r=e.previousEvent)==null?void 0:r.restoreFocus);o!=null&&!o||T(()=>{const n=f(t);n==null||n.focus({preventScroll:!0})})},invokeOnOpen({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!0})})},invokeOnClose({prop:e,flush:t}){t(()=>{var o;(o=e("onOpenChange"))==null||o({open:!1})})},toggleVisibility({event:e,send:t,prop:o}){t({type:o("open")?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:e})}}}});pe()(["autoFocus","closeOnEscape","closeOnInteractOutside","dir","getRootNode","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","onRequestDismiss","defaultOpen","open","persistentElements","portalled","positioning"]);const xe=e=>{const t=a.useId(),{getRootNode:o}=le(),{dir:r}=ce(),n={id:t,dir:r,getRootNode:o,...e},s=ue(be,n);return we(s,ge)},Ne=e=>{const[t,{children:o,...r}]=X(e),n=xe(r),s=z(h({present:n.open},t));return p.jsx(Oe,{value:n,children:p.jsx(ee,{value:s,children:o})})},V=a.forwardRef((e,t)=>{const o=O(),r=x(),n=h({...o.getTriggerProps(),"aria-controls":r.unmounted?void 0:o.getTriggerProps()["aria-controls"]},e);return p.jsx(y.button,{...n,ref:t})});V.displayName="PopoverTrigger";const W=a.createContext(void 0);function M({children:e,onPositionChange:t,positionerStyle:o}){const[r,n]=a.useState(),[s,i]=a.useState();return p.jsx(W.Provider,{value:{contentId:r,onPositionChange:t,positionerStyle:o,setContentId:n,setTriggerId:i,triggerId:s},children:e})}function N(){return he(W)}M.__docgenInfo={description:"",methods:[],displayName:"PopoverProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}},composes:["Pick"]};const Fe=({autoFocus:e=!0,children:t,gutter:o,onOpenChange:r,open:n,position:s=Q.top,sameWidth:i,triggerId:l,...c})=>{const{contentId:m,triggerId:v}=N();return p.jsx(Ne,{autoFocus:e,ids:{content:m,trigger:l??v},onOpenChange:r,open:n,positioning:{gutter:o,placement:s,sameWidth:i},...c,children:t})},K=({onPositionChange:e,positionerStyle:t,...o})=>p.jsx(M,{onPositionChange:e,positionerStyle:t,children:p.jsx(Fe,{...o})});K.displayName="Popover";K.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{autoFocus:{required:!1,tsType:{name:"boolean"},description:"Whether to automatically set focus on the first focusable content within the popover when opened."},gutter:{required:!1,tsType:{name:"number"},description:"The main axis offset or gap between the reference and floating elements"},onOpenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(detail: PopoverOpenChangeDetail) => void",signature:{arguments:[{type:{name:"PopoverOpenChangeDetail"},name:"detail"}],return:{name:"void"}}},description:"Callback fired when the popover open state changes."},onPositionChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(detail: PopoverPositionChangeDetail) => void",signature:{arguments:[{type:{name:"PopoverPositionChangeDetail"},name:"detail"}],return:{name:"void"}}},description:"Callback fired when the popover position changes."},open:{required:!1,tsType:{name:"boolean"},description:"The controlled open state of the popover."},position:{required:!1,tsType:{name:"literal",value:"`${OVERLAY_POSITION}`"},description:`@type=POPOVER_POSITION
The popover position around the trigger.`},positionerStyle:{required:!1,tsType:{name:"CSSProperties"},description:"Custom style applied to the overlay positioner. Useful if you want to override the overlay z-index."},sameWidth:{required:!1,tsType:{name:"boolean"},description:"Whether to make the floating element same width as the reference element."},triggerId:{required:!1,tsType:{name:"string"},description:"ID of an external trigger element to use in place of the PopoverTrigger component."}}};const Re={"popover-content":"_popover-content_3od5l_2"},U=a.forwardRef(({children:e,className:t,createPortal:o=!0,id:r,withArrow:n=!1,...s},i)=>{const l=a.useId(),{onPositionChange:c,positionerStyle:m,setContentId:v}=N(),{open:E}=O(),u=a.useRef(null),d=a.useMemo(()=>r??l,[l,r]);return a.useImperativeHandle(i,()=>u.current,[u]),a.useEffect(()=>{v(d)},[d,v]),a.useEffect(()=>{if(u.current){const C=new MutationObserver(F=>{if(F.length){const Y=F[0].target.dataset;c==null||c({position:Y.placement})}});return C.observe(u.current,{attributeFilter:["data-placement"],attributes:!0}),()=>{C.disconnect()}}},[u,c]),p.jsx(Z,{disabled:!o,children:p.jsx(q,{style:{zIndex:"var(--ods-theme-overlay-z-index)",...m||{}},children:p.jsxs(A,{className:L(Re["popover-content"],t),"data-ods":"popover-content",ref:u,...s,style:{...s.style,...E?{}:{display:"none"}},children:[n&&p.jsx(j,{children:p.jsx(_,{})}),e]})})})});U.displayName="PopoverContent";U.__docgenInfo={description:"",methods:[],displayName:"PopoverContent",props:{createPortal:{required:!1,tsType:{name:"boolean"},description:"Whether the component should be rendered in the DOM close to the body tag.",defaultValue:{value:"true",computed:!1}},withArrow:{required:!1,tsType:{name:"boolean"},description:"Whether the component displays an arrow pointing to the trigger.",defaultValue:{value:"false",computed:!1}}},composes:["ComponentPropsWithRef"]};const De={"popover-trigger":"_popover-trigger_zwyzw_2"},H=a.forwardRef(({asChild:e,children:t,className:o,...r},n)=>{const{setTriggerId:s}=N();return a.useEffect(()=>{var i;if(!e&&r.id){s==null||s(r.id);return}t&&((i=t.props)!=null&&i.id)&&(s==null||s(t.props.id))},[e,t,r,s]),p.jsx(V,{asChild:e,className:L(De["popover-trigger"],o),"data-ods":"popover-trigger",ref:n,role:"button",tabIndex:0,...r,children:t})});H.displayName="PopoverTrigger";H.__docgenInfo={description:"",methods:[],displayName:"PopoverTrigger",props:{asChild:{required:!1,tsType:{name:"boolean"},description:`Use the provided child element as the default rendered element, combining their props and behavior.
Be careful to pass an actual Node, not a Fragment.`}},composes:["ComponentPropsWithRef"]};export{H as P,U as a,K as b};
