@use '../../../../../style/focus';
@use '../../../../../style/input';
@import '~vanillajs-datepicker/dist/css/datepicker.min.css';

$ods-datepicker-item-size: 32px;
$ods-datepicker-padding: 6px;
$ods-datepicker-clearable-button-size: input.$ods-input-actions-button-width;

@mixin custom-view() {
  height: $ods-datepicker-item-size;

  &:not(.disabled) {
    &:not(.focused) {
      color: var(--ods-color-primary-500);

      &:hover {
        background-color: var(--ods-color-primary-200);
      }
    }
  }

  &.disabled {
    cursor: not-allowed;
    color: var(--ods-color-neutral-100);
  }

  &.focused {
    background-color: var(--ods-color-primary-800);
    color: var(--ods-color-primary-000);
  }
}

:host(.ods-datepicker) {
  display: inline-block;
  position: relative;
}

.ods-datepicker {
  &__input {
    $input: &;

    @include input.ods-input();

    padding-right: input.$ods-input-input-padding-right;

    &:not(:disabled)#{$input}--error {
      @include input.ods-input-error();

      ~.datepicker {
        .datepicker-picker {
          @include input.ods-input-error();
        }
      }
    }

    &--clearable,
    &--loading {
      padding-right: input.$ods-input-input-padding-right * 2;
    }
  }

  &__actions {
    display: flex;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    flex-flow: row;
    column-gap: $ods-datepicker-padding;
    align-items: center;
    padding: $ods-datepicker-padding;

    &__spinner {
      margin-right: $ods-datepicker-padding;
      height: auto;

      &::part(spinner) {
        width: 1rem;
        height: 1rem;
      }
    }

    &__clearable {
      border: none;
      border-radius: 2px;
      background: none;
      cursor: pointer;
      padding: 0;
      width: $ods-datepicker-clearable-button-size;
      height: $ods-datepicker-clearable-button-size;
      color: var(--ods-color-neutral-600);
      font-size: 0.75rem;

      &:disabled {
        cursor: not-allowed;
      }

      &:focus-visible {
        @include focus.ods-focus();

        outline-offset: 0;
      }

      &:not(:disabled, &--readonly) {
        &:hover {
          background-color: var(--ods-color-neutral-100);
        }

        &:active {
          background-color: var(--ods-color-neutral-200);
        }
      }
    }

    &__icon {
      color: var(--ods-color-primary-500);

      &--disabled {
        color: var(--ods-color-neutral-500);
      }
    }
  }
}

.datepicker {
  .datepicker-picker {
    border: var(--ods-border-width-sm) solid var(--ods-form-element-border-color-default);
    box-shadow: none;
    padding: 4px;

    .datepicker-header {
      .datepicker-controls {
        .next-button:not(:disabled),
        .prev-button:not(:disabled),
        .view-switch {
          color: var(--ods-color-primary-500);

          &:hover {
            background-color: var(--ods-color-primary-200);
          }
        }

        .next-button:disabled,
        .prev-button:disabled {
          color: var(--ods-color-neutral-100);

          &:hover {
            background-color: inherit;
          }
        }

        .view-switch {
          display: flex;
          flex-flow: row;
          column-gap: 6px;
          font-weight: 600;
        }
      }
    }

    .datepicker-main {
      .datepicker-view {
        &.months {
          .month {
            @include custom-view();
          }
        }

        &.years {
          .year {
            @include custom-view();
          }
        }

        .days {
          .days-of-week {
            .dow {
              width: $ods-datepicker-item-size;
              height: $ods-datepicker-item-size;
              color: var(--ods-color-text);
              font-size: 1rem;
              font-weight: 400;
            }
          }

          .datepicker-grid {
            .day {
              border-radius: 50%;
              font-weight: 600;

              &:not(.disabled) {
                color: var(--ods-color-primary-500);

                &:not(.selected):hover {
                  background-color: var(--ods-color-primary-200);
                }

                &.next,
                &.prev {
                  opacity: .5;
                }
              }

              &.disabled {
                cursor: not-allowed;
              }

              &.focused {
                @include focus.ods-focus();

                z-index: 1;
                outline-offset: 0;
                background-color: inherit;
              }

              &.selected {
                background-color: var(--ods-color-primary-800);
                color: var(--ods-color-primary-000);
              }
            }
          }
        }
      }
    }
  }
}
