@keyframes datepicker-appear {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

:host(.ods-datepicker) {
  display: inline-block;
  flex-direction: column;
}

:host {
  .ods-datepicker {
    &__input {
      width: 100%;
      min-width: calc((40px - 4px) * 7 + 20px * 2 + 1px * 2);

      & .ods-input__input--calendar {
        min-width: calc((40px - 4px) * 7 + 20px * 2 + 1px * 2);
      }

      &::part(input) {
        width: 100%;

        .ods-input__actions__calendar {
          font-size: 1.5rem;
        }
      }
    }

    &__hidden-input {
      display: none;
      width: 0;
    }
  }

  .datepicker {
    display: none;
    position: relative;
    z-index: 99;
    animation: datepicker-appear 0.2s ease-in-out;
    width: 0;
    height: 0;

    * {
      color: var(--ods-color-primary-500);
      transition: background-color 0.1s ease-in-out;
      line-height: 20px;
      letter-spacing: normal;
      font-family: var(--ods-font-family-default);
      font-size: 16px;
      font-weight: 600;
    }

    .datepicker-picker {
      position: absolute;
      border-style: solid;
      border: var(--ods-border-width-sm) solid var(--ods-form-element-border-color-default);
      border-width: 1px;
      border-radius: 4px;
      margin-top: 6px;
      padding: 8px 20px 16px 20px;
      height: fit-content;
      background-color: var(--ods-color-primary-000);

      .datepicker-header,
      .datepicker-controls {
        display: flex;
        justify-content: space-between;
        width: 100%;

        .prev-btn,
        .next-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          border: none;
          cursor: pointer;
          border-radius: 50%;
          width: calc(40px - 4px);
          min-width: calc(40px - 4px);
          height: calc(40px - 4px);
          min-height: calc(40px - 4px);
          background: none;

          &[disabled] {
            opacity: 0.5;
            pointer-events: none;
          }

          &:hover {
            background: var(--ods-color-primary-100);
          }
        }

        .view-switch {
          display: flex;
          align-items: center;
          justify-content: center;
          border: none;
          cursor: pointer;
          border-radius: 4px;
          width: 100%;
          background: none;

          &:hover {
            background: var(--ods-color-primary-100);
          }
        }
      }

      .datepicker-main {
        margin-top: 8px;

        .datepicker-grid {
          display: grid;
          grid-template-rows: repeat(3, 1fr);
          grid-template-columns: repeat(4, 1fr);

          .datepicker-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            width: calc(calc(40px - 4px) * 1.75);
            height: calc(40px - 4px);
            background: none;

            &:hover {
              background: var(--ods-color-primary-100);
            }
          }

          .disabled {
            opacity: 0.5;
          }

          .selected,
          .selected:hover {
            background: var(--ods-color-primary-100);
            color: var(--ods-color-primary-000);
          }
        }

        .datepicker-view {
          .days {
            .days-of-week {
              display: grid;
              grid-template-columns: repeat(7, 1fr);

              .dow {
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: default;
                width: calc(40px - 4px);
                height: calc(40px - 4px);
                color: var(--ods-color-text);
              }
            }

            .datepicker-grid {
              display: grid;
              grid-template-rows: repeat(6, 1fr);
              grid-template-columns: repeat(7, 1fr);

              .datepicker-cell {
                display: flex;
                align-items: center;
                justify-content: center;
                border: none;
                cursor: pointer;
                border-radius: 50%;
                width: calc(40px - 4px);
                height: calc(40px - 4px);
                background: none;

                &:hover {
                  background: var(--ods-color-primary-100);
                }
              }

              .selected,
              .selected:hover {
                background: var(--ods-color-primary-100);
                color: var(--ods-color-primary-000);
              }

              .prev.no-displayed,
              .next.no-displayed {
                opacity: 0;
                cursor: default;
                pointer-events: none;
              }

              .prev,
              .next,
              .disabled {
                opacity: 0.5;
              }
            }
          }
        }
      }
    }
  }
}

:host([hasFocus]) {
  .datepicker {
    display: flex;
  }
}

:host([disabled]) {
  .datepicker {
    display: none;
  }
}

:host([error]) {
  .datepicker {
    .datepicker-picker {
      border-color: var(--ods-color-critical-500);
    }
  }

  .ods-datepicker {
    &__input {
      &::part(input) {
        border-color: var(--ods-color-critical-500);
      }
    }
  }
}
