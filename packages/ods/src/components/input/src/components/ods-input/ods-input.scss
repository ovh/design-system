@use '~@ovhcloud/ods-themes/src/default/variables' as theme;
@use '../../../../../style/focus';
@use '../../../../../style/input';

:host(.ods-input) {
  position: relative;
}

$ods-input-button-right: 4px;
$ods-input-button-top: -1px;

.ods-input {
  &__button {
    $button: &;

    display: inline-flex;
    position: absolute;
    top: $ods-input-button-top;
    right: $ods-input-button-right;
    border: none;
    border-radius: 2px;
    background: none;
    cursor: pointer;
    color: theme.$ods-color-primary-500;

    &:focus-visible {
      @include focus.ods-focus();
    }

    &:hover {
      background-color: theme.$ods-color-primary-100;
    }

    &:active {
      background-color: theme.$ods-color-primary-200;
    }

    &__clearable {
      color: theme.$ods-color-neutral-600;

      &:has(+ #{$button}) {
        right: 30px;
      }

      &:hover {
        background-color: theme.$ods-color-neutral-100;
      }

      &:active {
        background-color: theme.$ods-color-neutral-200;
      }
    }
  }

  &__input {
    $input: &;

    @include input.ods-input();

    &:not(#{$input}--error, #{$input}--disabled) {
      &:focus {
        border-color: theme.$ods-form-element-border-color-focused;
      }

      &:hover {
        border-color: theme.$ods-form-element-border-color-hover;
      }
    }

    &--disabled {
      background-color: theme.$ods-color-neutral-100;
      cursor: not-allowed;
      user-select: none;

      ~ .ods-input__button {
        cursor: not-allowed;
      }
    }

    &--error {
      border-color: theme.$ods-form-element-border-color-critical;
    }

    &[type="number"] {
      appearance: textfield;
    }
  }

  &__spinner {
    position: absolute;
    top: $ods-input-button-top;
    right: $ods-input-button-right;
    padding: 0 4px;

    &::part(spinner) {
      width: 1rem;
      height: 1rem;
    }
  }
}
