<!DOCTYPE html>
<html dir='ltr' lang='en'>
<head>
  <meta charset='utf-8'/>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0'/>
  <title>Dev osds-input</title>

  <script type="module">
    !window.ods && (window.ods = {config: {logging: {active:true}}});
  </script>

  <script type='module' src='/build/osds-input.esm.js'></script>
  <script nomodule src='/build/osds-input.js'></script>
  <link rel="stylesheet" href="/build/osds-input.css">
  <style>
    .error-msg {
      display: none;
      background: gray;
    }
  </style>
</head>
<body style="margin: 0;">

  <section style="background: none; padding: 1em;">
    <h2>[types]</h2>
    <table style="width: 100%;" id="input-table"></table>
  </section>
  <section style="background: none; padding: 1em;">
    <h2>[colors]</h2>
    <table style="width: 100%;" id="input-table-color"></table>
  </section>
  <section style="background: #000e9c; padding: 1em;">
    <h2 style="color: #fff;">[contrasted]</h2>
    <table style="width: 100%;" id="input-table-contrasted"></table>
  </section>
  <section style="background: none; padding: 1em;">
    <h2>[flex]</h2>
    <table style="width: 100%;" id="input-table-flex"></table>
  </section>

  <script>
    const types = [
      'email', 
      'number', 
      'password', 
      'search', 
      'tel', 
      'text', 
      'url'
    ];

    const attributes = [
      `default`,
      `clearable`,
      `icon="ovh"`,
      `clearable icon="ovh"`,
      `value="ODS ahead"`,
      `value="ODS ahead" masked`,
      `loading`,
      `loading icon="ovh"`,
      `loading disabled`,
      `loading disabled icon="ovh"`,
    ];

    const colors = [
      'default', 
      'primary', 
      'text', 
      'accent', 
      'error', 
      'warning', 
      'success', 
      'info', 
      'promotion'
    ];

    const placeholder = (type) => `Enter ${type}...`;

    const rows = attributes.map(attribute => 
      `<tr>
        <td>${attribute}</td>
        ${types.map(type => 
          `<td><osds-input type="${type}" placeholder="${placeholder(type)}" ${attribute}></osds-input></td>`).join('')
        }
      </tr>`
    ).join('');

    document.getElementById('input-table').innerHTML = `<thead><tr><td></td>${types.map(type => `<td>${type}</td>`).join('')}</tr></thead><tbody>${rows}</tbody>`;

    const colorRows = attributes.map(attribute => 
      `<tr>
        <td>${attribute}</td>
        ${colors.map(color => 
          `<td><osds-input color="${color}" type="text" placeholder="${placeholder('text')}" ${attribute}></osds-input></td>`).join('')
        }
      </tr>`
    ).join('');

    document.getElementById('input-table-color').innerHTML = `<thead><tr><td></td>${colors.map(color => `<td>${color}</td>`).join('')}</tr></thead><tbody>${colorRows}</tbody>`;

    const contrastedRows = attributes.map(attribute => 
      `<tr>
        <td style="color: #fff;">${attribute}</td>
        ${colors.map(color => 
          `<td><osds-input color="${color}" type="text" contrasted placeholder="${placeholder('text')}" ${attribute}></osds-input></td>`).join('')
        }
      </tr>`
    ).join('');

    document.getElementById('input-table-contrasted').innerHTML = `<thead><tr><td></td>${colors.map(color => `<td style="color: #fff;">${color}</td>`).join('')}</tr></thead><tbody>${contrastedRows}</tbody>`;

    const flexRows = attributes.map(attribute => 
      `<tr>
        <td>${attribute}</td>
        <td style="width: 80%;"><osds-input flex type="text" placeholder="${placeholder('text')}" ${attribute}></osds-input></td>
      </tr>`
    ).join('');

    document.getElementById('input-table-flex').innerHTML = `<thead><tr><td></td><td>flex</td></tr></thead><tbody>${flexRows}</tbody>`;
  </script>
  
  <article>
    <h2>[number odsInput-1]</h2>
    <osds-input
      id="odsInput-1"
      type="number"
      placeholder="Here is a number"
      min="1"
      max="4"
      step="2"
      color="primary"
      clearable
    >
    </osds-input>
  </article>

  <article>
    <h2>[number odsInput-2]</h2>
    <osds-input
      id="odsInput-2" type="number"
      value="8"
      min="0"
      max="14"
      step="4"
    >
    </osds-input>
  </article>
</section>

<article id="example-3">
  <h2>[number]</h2>
  <osds-input id="input-3" type="number" placeholder="Here is a number" min1="1" max1="4" step1="2" default-value="3">
  </osds-input><button onclick="input3Clear()">clear</button><button onclick="input3Reset()">reset</button>
  <span class="error-msg forbidden-value">Forbidden value</span>
  <span class="error-msg value-missing">Value required please</span>
  <span class="error-msg step-mismatch">Please insert a value by step 2, starting from 1</span>
  <span class="error-msg valid">Not valid</span>
</article>
<section>

</section>

<script>
  const odsInput1 = document.querySelector('osds-input#odsInput-1');
  const odsInput2 = document.querySelector('osds-input#odsInput-2');


  let logger;
  document.addEventListener('odsInitialized', ({detail}) => {
    const instance = detail.instance;
    instance.logging(true);
    logger = new instance.logger('www');
    logger.log('odsInitialized received');
  })

  odsInput1.addEventListener('odsValueChange', (event) => {
    logger && logger.log("ðŸŸ¡ odsValueChange event", event.detail);

    odsInput1.getValidity().then((validity) => {
      logger && logger.log("ðŸŸ¡ getValidity odsInput-1 from Event", validity);
    });
  })

  async function getValidityForOdsInput1() {
    await customElements.whenDefined('osds-input');
    odsInput1.getValidity().then((validity) => {
      logger && logger.log("ðŸŸ¡ getValidity odsInput-1", validity);
    });
  }

  async function getValidityForOdsInput2() {
    await customElements.whenDefined('osds-input');
    odsInput2.getValidity().then((validity) => {
      logger && logger.log("ðŸ”´ getValidity odsInput-2", validity);
    });
  }

  getValidityForOdsInput1();
  getValidityForOdsInput2();

</script>

</body>
</html>
