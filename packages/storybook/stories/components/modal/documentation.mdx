import { Canvas, Meta } from '@storybook/blocks';
import * as ModalStories from './modal.stories';
import { Banner } from '../../../src/components/banner/Banner';
import { BestPractices } from '../../../src/components/bestPractices/BestPractices';
import { Heading } from '../../../src/components/heading/Heading';
import { IdentityCard } from '../../../src/components/identityCard/IdentityCard';
import { StorybookLink } from '../../../src/components/storybookLink/StorybookLink';
import { ATOMIC_TYPE } from '../../../src/constants/atomicDesign';

<Meta of={ ModalStories } name="Documentation" />

<Banner of={ ModalStories } />

_A **Modal** component is used to overlay with important content the main view of a site and block interactions with it._

<Canvas of={ ModalStories.Overview } sourceState="none" />

<Heading label="Overview" level={ 2 } />

<IdentityCard aliases={ ['Dialog', 'Alert Dialog', 'Confirm Dialog'] }
              atomicType={ ATOMIC_TYPE.molecule }
              figmaLink="https://www.figma.com/design/9jDDTcR4a9jPRFcdjawAlf/ODS---UI-Kit?node-id=47-2607"
              githubUrl="https://github.com/ovh/design-system/tree/master/packages/ods/src/components/modal"
              name="Modal"
              relatedComponents={ [{ name: 'Button' }, { name: 'Text' }] }>
  A **Modal** is used to provide some information to users that needs a response or immediate attention.

  While a **Modal** is triggered, there is no interaction possible on the page that is overlaid so users have to
  dismiss or click on an action <StorybookLink kind="ODS Components/Button" label="Button" story="Documentation" /> to proceed
  further.
</IdentityCard>

<Heading label="Anatomy" level={ 2 } />

![Component anatomy](components/modal/anatomy.png "Component anatomy")

1. **Backdrop overlay** to obscure the on-page content
2. **Container**
3. **Content** container, filled with <StorybookLink kind="ODS Components/Text" label="Text" story="Documentation" /> or other read-only content, depending on the usage
4. **Action Buttons** container, to complete or cancel the **Modal** task
5. **`close` icon Button** to close the **Modal** without submitting any data

<Heading label="Usage" level={ 2 } />

**Modals** are used in different cases:
- alerting users about something that requires their agreement
- confirming a user decision
- notifying the user of an important information

There are five different subtypes of **Modals** to inform users that a problem requires immediate response from them so the process can continue, depending on the usage:
- **Neutral**: reserved for standard alerting
- **Information**: provides information to users in context
- **Success**: reserved to provide a static persistent success information
- **Warning**: reserved for **Modals** that need the user attention and acknowledgment but might not cause errors
- **Critical**: reserved for errors, malfunctions, as well as critical issues

They can be dismissable or not.

<Heading label="Dos & Don'ts" level={ 3 } />

<BestPractices
  donts={[
    '- Trigger a Modal as a result of a first Modal actions',
    '- Use a Modal if the informational content is very long within a Modal: consider alternatives if that is your case',
    <span>- Use a **Modal** only to notify users about a successful completion of their actions: use <StorybookLink kind="ODS Components/Message" label="Message" story="Documentation" /> component</span>,
  ]}
  dos={[
    '- Use a Modal to display information the user needs to respond to',
    '- Use a Modal to ask a confirmation from the user before proceeding',
    '- Use Modals sparingly since they are disruptive and stop users in their current task',
    <span>- Handle closing the Modal when the cancel action <StorybookLink kind="ODS Components/Button" label="Button" story="Documentation" /> is clicked</span>,
    '- Use scrolling only when it is absolutely needed',
  ]}
/>

<Heading label="Placement" level={ 2 } />

When a **Modal** opening is triggered, it is displayed with a position aligned both horizontally and vertically within the viewport.

**Modal** takes up 100% of the viewport width up to a maximum width of 512px.

<Heading label="Behavior" level={ 2 } />

<Heading label="Overlay" level={ 3 } />

A background overlay with opacity is displayed on the page to avoid distraction and help users to focus on the **Modal** content.

When the **Modal** opens, an event is triggered.

An animation with the ease-in and out effect applies on opening.

<Heading label="Closing" level={ 3 } />

A **Modal** is dismissed by clicking on the close icon button.

Dismissing a **Modal** means that it will be closed without submitting any data and the user won't proceed further.

A **Modal** will be successfully closed only once the required action or response has been completed by the user, meaning that the task is completed so the user will proceed further.

Closing the **Modal** triggers an event and an animation.

The hidden overflow behaviour is removed whenever the **Modal** get closed.

<Heading label="Scrolling" level={ 3 } />

When necessary, depending on the viewport height and the **Modal** content, the user can scroll vertically with the header and the action <StorybookLink kind="ODS Components/Button" label="Button" story="Documentation" /> remaining in place.

<Heading label="Variation" level={ 2 } />

<Heading label="Color" level={ 3 } />

- **Neutral**: providing general information or updates without implying any particular urgency or emotion.
- **Success**: indicating that an action has been successfully completed, offering positive reinforcement to the user.
- **Warning**: alerting users to potential issues or risks, encouraging caution and preventive measures.
- **Critical**: highlighting urgent and severe issues that require immediate attention and action to prevent significant negative outcomes.

<Heading label="Accessibility" level={ 2 } />

When displayed, the user is directly focused on the **Modal** itself.

When **Modal** is opened :
- `Escape` key will dismiss it (if dismissible)
- `Tabulation` allows to move forward, first to the closing icon, then through any focusable element in the **Modal** (e.g. action <StorybookLink kind="ODS Components/Button" label="Button" story="Documentation" />)
- `Shift + Tab` allows the opposite way to move backward in focusing items

Focus is trapped inside the **Modal** scope and inner elements when active.
