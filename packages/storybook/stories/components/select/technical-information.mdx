import { Canvas, Meta } from '@storybook/blocks';
import { OdsMessage } from '@ovhcloud/ods-components/react';
import SpecificationsSelect from '@ovhcloud/ods-components/src/components/select/documentation/custom-elements.json';
import { Banner } from '../../../src/components/banner/Banner';
import { Heading } from '../../../src/components/heading/Heading';
import { TechnicalSpecification } from '../../../src/components/technicalSpecification/TechnicalSpecification';
import { hideValidityStateSource } from '../../../src/components/validityState/validityState';
import * as SelectStories from './select.stories';
import { Select as FormFieldSelect } from '../form-field/form-field.stories';

<Meta of={ SelectStories } name="Technical information" />

<Banner of={ SelectStories } />

<Heading label="Overview" level={ 2 } />

<Canvas of={ SelectStories.Overview } sourceState="none" />

<TechnicalSpecification data={ SpecificationsSelect } />

<Heading label="Style customization" level={ 2 } />

You can add your own style on the select element by adding class on the webcomponent directly.

Custom CSS:

<Canvas of={ SelectStories.CustomCSS } sourceState="shown" />

<Heading label="Examples" level={ 2 } />

<Heading label="Default" level={ 3 } />

<Canvas of={ SelectStories.Default } sourceState="shown" />

<Heading label="Group" level={ 3 } />

<Canvas of={ SelectStories.Optgroup } sourceState="shown" />

<Heading label="Multiple Selection" level={ 3 } />

<Canvas of={ SelectStories.Multiple } sourceState="shown" />

<Heading label="Disabled" level={ 3 } />

<Canvas of={ SelectStories.Disabled } sourceState="shown" />

<Heading label="Disabled option" level={ 3 } />

<Canvas of={ SelectStories.DisabledOption } sourceState="shown" />

<Heading label="Disabled group of options" level={ 3 } />

<Canvas of={ SelectStories.DisabledGroupOfOptions } sourceState="shown" />

<Heading label="Readonly" level={ 3 } />

<Canvas of={ SelectStories.Readonly } sourceState="shown" />

<Heading label="Custom Renderer" level={ 3 } />

If you want to display something more complex that just a string, you can use your own render functions instead of native elements.

You can customize either:
- `item`: the currently selected element
- `option`: an option on the select option list

By default, each render function will receive as argument an object containing the following properties:
- `text`: the label of the option
- `value`: the value of the option

If you need more data per option, you can attach a `data-attribute` to each option, the value will be available
on the render function as well.

<OdsMessage color="warning" isDismissible={ false }>Updating the "customRenderer" attribute after the initial render will not update the component. You need to explicitly call the "updateCustomRenderer" method to apply the change.</OdsMessage>

Here is an example of the customization of each elements using specific data:

<Canvas of={ SelectStories.CustomRenderer } sourceState="shown" />

<Heading label="Custom Renderer For Multiple Selection" level={ 3 } />

If you set the property `allow-multiple`, custom option rendering is quite the same as, except that you'll
have to take into account the selection checkbox that will be injected in the DOM.

As for now, item template is not customizable and will always render as the count of selected items.

Here is the same example as previously updated for multiple selection:

<Canvas of={ SelectStories.CustomRendererMultiple } sourceState="shown" />

<Heading label="Validity State" level={ 3 } />

<Canvas of={ SelectStories.ValidityState } source={{ transform: hideValidityStateSource }} sourceState="shown" />

<Heading label="In an ods-modal" level={ 3 } />

If the component container is defining a position context, the select may not appear at the right place, or partially clipped.

In that case, you can change the component `strategy` prop to `fixed`, this way it will position itself based on the
nearest containing block (usually the viewport).

Careful though, you'll have to manage the induced layout changes (like setting a width) as your component will no longer be rendered as part of your block but in a separate layer.

<Canvas of={ SelectStories.FixedContext } sourceState="shown" />

<Heading label="Included in a Form Field" level={ 3 } />

<Canvas of={ FormFieldSelect } sourceState="shown" />
